<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script src="/cdn-cgi/apps/head/3cOPSgo5Omz84ycX7CvigfX4cpw.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-82213539-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-82213539-2');
    </script>
    <title>4 &#37197;&#32622; 4.0.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        The Grails Framework
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/introduction.html"><strong>1</strong><span>&#31616;&#20171;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>2</strong><span>&#20837;&#38376;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/upgrading.html"><strong>3</strong><span>&#20174; Grails 3.3.x &#21319;&#32423;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/conf.html"><strong>4</strong><span>&#37197;&#32622;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/commandLine.html"><strong>5</strong><span>&#21629;&#20196;&#34892;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/profiles.html"><strong>6</strong><span>&#24212;&#29992;&#31243;&#24207;&#37197;&#32622;&#25991;&#20214;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/GORM.html"><strong>7</strong><span>&#23545;&#35937;&#20851;&#31995;&#26144;&#23556; &#65288;GORM&#65289;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/theWebLayer.html"><strong>8</strong><span>Web &#23618;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/traits.html"><strong>9</strong><span>&#29305;&#24449;&#65288;Trait&#65289;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/REST.html"><strong>10</strong><span>REST</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/async.html"><strong>11</strong><span>&#24322;&#27493;&#32534;&#31243;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/validation.html"><strong>12</strong><span>&#39564;&#35777;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/services.html"><strong>13</strong><span>&#26381;&#21153;&#23618;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/staticTypeCheckingAndCompilation.html"><strong>14</strong><span>&#38745;&#24577;&#31867;&#22411;&#26816;&#26597;&#21644;&#32534;&#35793;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/testing.html"><strong>15</strong><span>&#27979;&#35797;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/i18n.html"><strong>16</strong><span>&#22269;&#38469;&#21270;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/security.html"><strong>17</strong><span>&#23433;&#20840;&#24615;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/plugins.html"><strong>18</strong><span>&#25554;&#20214;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/spring.html"><strong>19</strong><span>Grails &#19982; Spring</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/scaffolding.html"><strong>20</strong><span>&#33050;&#25163;&#26550;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/deployment.html"><strong>21</strong><span>&#37096;&#32626;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/contributing.html"><strong>22</strong><span>&#32473; Grails &#36129;&#29486;&#20195;&#30721;</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/upgrading.html">&lt;&lt; <strong>3</strong><span>&#20174; Grails 3.3.x &#21319;&#32423;</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/commandLine.html"><strong>5</strong><span>&#21629;&#20196;&#34892;</span> >></a></div>
                


                <div class="project">
                    <h1>4 &#37197;&#32622;</h1>

                    <p><strong>Version:</strong> 4.0.0</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#config"><strong>4.1</strong><span>&#22522;&#26412;&#37197;&#32622;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#ymlOptions"><strong>4.1.1</strong><span>YML &#26684;&#24335;&#36873;&#39033;&#37197;&#32622;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#builtInOptions"><strong>4.1.2</strong><span>&#20869;&#32622;&#36873;&#39033;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#logging"><strong>4.1.3</strong><span>&#26085;&#24535;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#loggerName"><strong>4.1.3.1</strong><span>&#35760;&#24405;&#22120;&#21517;&#31216;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#maskingRequestParametersFromStacktraceLogs"><strong>4.1.3.2</strong><span>&#20174;&#22534;&#26632;&#36319;&#36394;&#26085;&#24535;&#23631;&#34109;&#35831;&#27714;&#21442;&#25968;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:20px"><a href="#externalLoggingConfiguration"><strong>4.1.3.3</strong><span>&#22806;&#37096;&#37197;&#32622;&#25991;&#20214;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#configGORM"><strong>4.1.4</strong><span>GORM</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#proxyConfig"><strong>4.1.5</strong><span>&#37197;&#32622; HTTP &#20195;&#29702;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#applicationClass"><strong>4.2</strong><span>&#24212;&#29992;&#31243;&#24207;&#31867;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#executing"><strong>4.2.1</strong><span>&#25191;&#34892;&#24212;&#29992;&#31243;&#24207;&#31867;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#customizing"><strong>4.2.2</strong><span>&#33258;&#23450;&#20041;&#24212;&#29992;&#31243;&#24207;&#31867;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#applicationLifeCycle"><strong>4.2.3</strong><span>&#24212;&#29992;&#31243;&#24207;&#29983;&#21629;&#21608;&#26399;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#environments"><strong>4.3</strong><span>&#29615;&#22659;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#dataSource"><strong>4.4</strong><span>&#25968;&#25454;&#28304;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#dataSourcesAndEnvironments"><strong>4.4.1</strong><span>&#25968;&#25454;&#28304;&#21644;&#29615;&#22659;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#automaticDatabaseMigration"><strong>4.4.2</strong><span>&#33258;&#21160;&#25968;&#25454;&#24211;&#36801;&#31227;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#transactionAwareDataSourceProxy"><strong>4.4.3</strong><span>&#20107;&#21153;&#24863;&#30693;&#25968;&#25454;&#28304;&#20195;&#29702;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#databaseConsole"><strong>4.4.4</strong><span>&#25968;&#25454;&#24211;&#25511;&#21046;&#21488;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#multipleDatasources"><strong>4.4.5</strong><span>&#22810;&#20010;&#25968;&#25454;&#28304;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#versioning"><strong>4.5</strong><span>&#29256;&#26412;&#25511;&#21046;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#dependencyResolution"><strong>4.6</strong><span>&#20381;&#36182;&#39033;&#35299;&#26512;</span></a>
                    </div>
                    
                </div>
                

                
<a name="3. &#37197;&#32622;"><!-- Legacy link --></a>
<h1 id="conf">4 配置</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>在我们现在讨论这个主题的，包含“约定之上的约定”的框架中，这似乎很奇怪。
正如快速入门所示，使用Grails的默认设置，您实际上可以在不进行任何配置的情况下开发应用程序，但是重要的是要了解在需要时在何处以及如何覆盖约定。
用户指南的后面各节将提及您可以使用哪些配置设置，但没有介绍如何设置它们。假设您至少已经阅读了本章的第一部分！</p>
</div>

<a name="3.1 &#22522;&#26412;&#37197;&#32622;"><!-- Legacy link --></a>
<h2 id="config">4.1 基本配置</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails 中的配置通常分为两个区域：构建配置和运行时配置。</p>
</div>
<div class="paragraph">
<p>通常通过 Gradle 和 <code>build.gradle</code> 文件来完成构建配置。默认情况下，运行时配置是在YAML中的 <code>grails-app/conf/application.yml</code> 文件中指定的。</p>
</div>
<div class="paragraph">
<p>如果您更喜欢使用 Grails 2.0 风格的 Groovy 配置，则可以使用 Groovy 的 <a href="http://docs.groovy-lang.org/latest/html/documentation/#_configslurper">ConfigSlurper</a> 语法指定配置。有两个 Groovy 配置文件：grails-app/conf/application.groovy 和 grails-app/conf/runtime.groovy：</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>使用 <code>application.groovy</code> 进行不依赖于应用程序类的配置</p>
</li>
<li>
<p>使用 <code>runtime.groovy</code> 进行不依赖于应用程序类的配置</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>这种分离是必要的，因为 Grails CLI 可以使用 <code>application.groovy</code> 中定义的配置值，Grails CLI 必须能够在编译应用程序之前加载 <code>application.groovy</code> 。当以下命令由 CLI 执行时，对 <code>application.groovy</code> 中的应用程序类的引用将导致异常：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>运行 Grails CLI 时发生错误：
启动失败：script14738267015581837265078.groovy：13：无法解析 com.foo.Bar 类</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>对于 Groovy 配置，以下变量可用于配置脚本：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>变量</strong></th>
<th class="tableblock halign-left valign-top"><strong>说明</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">userHome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">运行 Grails 应用程序的帐户的主目录的位置。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grailsHome</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">安装 Grails 的目录的位置。如果设置了 <code>GRAILS_HOME</code> 环境变量，则使用它。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在 build.gradle 中显示的应用程序名称。</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">appVersion</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">在 build.gradle 中显示的应用程序版本。</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">my.tmp.dir = <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>userHome<span class="inline-delimiter">}</span></span><span class="content">/.grails/tmp</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_使用_grailsapplication_访问配置">使用 GrailsApplication 访问配置</h3>
<div class="paragraph">
<p>如果您想读取运行时配置设置，即在 <code>application.yml</code> 中定义的设置，请使用 <a href="http://docs.grails.org/4.0.0/api/grails/core/GrailsApplication.html">grailsApplication</a> 对象，该对象可以在控制器和标记库中作为变量使用：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MyController</span> {
    <span class="keyword">def</span> <span class="function">hello</span>() {
        <span class="keyword">def</span> recipient = grailsApplication.config.getProperty(<span class="string"><span class="delimiter">'</span><span class="content">foo.bar.hello</span><span class="delimiter">'</span></span>)

        render <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">${</span>recipient<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>grailsApplication 对象的 config 属性是 <a href="http://docs.grails.org/4.0.0/api/grails/config/Config.html">Config</a> 接口的一个实例，并提供了许多有用的方法来读取应用程序的配置。</p>
</div>
<div class="paragraph">
<p>特别是，<code>getProperty</code> 方法（如上所示）对于有效检索配置属性非常有用，同时可以指定属性类型（默认类型为 String）和/或提供默认的后备值。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MyController</span> {

    <span class="keyword">def</span> <span class="function">hello</span>(Recipient recipient) {
        <span class="comment">//Retrieve Integer property 'foo.bar.max.hellos', otherwise use value of 5</span>
        <span class="keyword">def</span> max = grailsApplication.config.getProperty(<span class="string"><span class="delimiter">'</span><span class="content">foo.bar.max.hellos</span><span class="delimiter">'</span></span>, <span class="predefined-type">Integer</span>, <span class="integer">5</span>)

        <span class="comment">//Retrieve property 'foo.bar.greeting' without specifying type (default is String), otherwise use value &quot;Hello&quot;</span>
        <span class="keyword">def</span> greeting = grailsApplication.config.getProperty(<span class="string"><span class="delimiter">'</span><span class="content">foo.bar.greeting</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello</span><span class="delimiter">&quot;</span></span>)

        <span class="keyword">def</span> message = (recipient.receivedHelloCount &gt;= max) ?
          <span class="string"><span class="delimiter">&quot;</span><span class="content">Sorry, you've been greeted the max number of times</span><span class="delimiter">&quot;</span></span> :  <span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>greeting<span class="inline-delimiter">}</span></span><span class="content">, </span><span class="inline"><span class="inline-delimiter">${</span>recipient<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
        }

        render message
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>请注意， <code>Config</code> 实例是基于 Spring <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/PropertySource.html">PropertySource</a> 概念的合并配置，并从环境，系统属性和本地应用程序配置中读取配置，并将它们合并为单个对象。</p>
</div>
<div class="paragraph">
<p><code>GrailsApplication</code> 可以很容易地注入服务和其他 Grails 工件中：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.core.*</span>

<span class="type">class</span> <span class="class">MyService</span> {
    GrailsApplication grailsApplication

    <span class="predefined-type">String</span> greeting() {
        <span class="keyword">def</span> recipient = grailsApplication.config.getProperty(<span class="string"><span class="delimiter">'</span><span class="content">foo.bar.hello</span><span class="delimiter">'</span></span>)
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">${</span>recipient<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_grailsconfigurationaware_接口">GrailsConfigurationAware 接口</h3>
<div class="paragraph">
<p>在运行时动态访问配置会对应用程序性能产生很小的影响。一种替代方法是实现 <a href="http://docs.grails.org/4.0.0/api/grails/core/support/GrailsConfigurationAware.html">GrailsConfigurationAware</a> 接口，该接口提供了一个 <code>setConfiguration</code> 方法，该方法在初始化类时将应用程序配置作为参数接受。然后，您可以将相关的配置属性分配给类上的实例属性，以供以后使用。</p>
</div>
<div class="paragraph">
<p><code>Config</code> 实例与注入的 <code>GrailsApplication</code> config 对象具有相同的属性和用法。这是上一个示例中的服务类，使用的是 GrailsConfigurationAware 而不是注入 <code>GrailsApplication</code>：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.core.support.GrailsConfigurationAware</span>

<span class="type">class</span> <span class="class">MyService</span> <span class="directive">implements</span> GrailsConfigurationAware {

    <span class="predefined-type">String</span> recipient

    <span class="predefined-type">String</span> greeting() {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">${</span>recipient<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }

    <span class="type">void</span> setConfiguration(Config config) {
        recipient = config.getProperty(<span class="string"><span class="delimiter">'</span><span class="content">foo.bar.hello</span><span class="delimiter">'</span></span>)
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_spring_value_注解">Spring Value 注解</h3>
<div class="paragraph">
<p>您可以使用 Spring 的 <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/beans/factory/annotation/Value.html">Value</a> 批注注入配置值：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">org.springframework.beans.factory.annotation.*</span>

<span class="type">class</span> <span class="class">MyController</span> {
    <span class="annotation">@Value</span>(<span class="string"><span class="delimiter">'</span><span class="content">${foo.bar.hello}</span><span class="delimiter">'</span></span>)
    <span class="predefined-type">String</span> recipient

    <span class="keyword">def</span> <span class="function">hello</span>() {
        render <span class="string"><span class="delimiter">&quot;</span><span class="content">Hello </span><span class="inline"><span class="inline-delimiter">${</span>recipient<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
在 Groovy 代码中，必须在字符串周围使用单引号作为 <code>value</code> 注释的值，否则它将被解释为 GString 而不是 Spring 表达式。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>如您所见，访问配置设置时，使用与定义它们时相同的点符号。</p>
</div>
</div>


<h2 id="ymlOptions">4.1.1 YML 格式选项配置</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/ymlOptions.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails 3.0 中引入了 <code>application.yml</code> 文件，现在 YAML 是配置文件的首选格式。</p>
</div>
<div class="sect2">
<h3 id="_使用系统属性_命令行参数">使用系统属性/命令行参数</h3>
<div class="paragraph">
<p>假设您使用的是 <code>JDBC_CONNECTION_STRING</code> 命令行参数，并且希望在 yml 文件中访问该参数，则可以按以下方式执行：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">production</span>:
    <span class="key">dataSource</span>:
        <span class="key">url</span>: <span class="string"><span class="content">'${JDBC_CONNECTION_STRING}'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>同样，也可以访问系统参数。</p>
</div>
<div class="paragraph">
<p>如果使用 <code>grails run app</code> 启动应用程序，则需要在 <code>build.gradle</code> 中使用此命令来修改 <code>bootRun</code> 目标：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">bootRun {
    systemProperties = <span class="predefined-type">System</span>.properties
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>为了进行测试，需要将 <code>test</code> 任务更改如下</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">test {
    systemProperties = <span class="predefined-type">System</span>.properties
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_外部配置">外部配置</h3>
<div class="paragraph">
<p>默认情况下，Grails将从 <code>./config</code> 或当前目录中读取 <code>application.(properties | yml)</code> 。</p>
</div>
<div class="paragraph">
<p>因为 Grails 也是一个 SpringBoot，所以也提供了配置选项方式，有关文档，请参阅： <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-application-property-files" class="bare">https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-external-config.html#boot-features-external-config-application-property-files</a></p>
</div>
</div>

<a name="3.1.1 &#20869;&#32622;&#36873;&#39033;"><!-- Legacy link --></a>
<h2 id="builtInOptions">4.1.2 内置选项</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/builtInOptions.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails 有一组核心设置值得了解。它们的默认值适用于大多数项目，但了解它们的作用很重要，因为您可能需要这些设置中的一个或多个。</p>
</div>
<div class="sect2">
<h3 id="_运行时设置">运行时设置</h3>
<div class="paragraph">
<p>在运行时方面，即 <code>grails app/conf/application.yml</code> ，还有很多核心设置：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails.enable.native2ascii</code> - 如果不需要 grails i18n 属性文件的 native2ascii 转换，则将其设置为 false（默认值：true）。</p>
</li>
<li>
<p><code>grails.views.default.codec</code> - 设置 GSPs 的默认编码机制——可以是 'none', 'html', 或者 'base64' 之一（默认值：'none'）。要降低 XSS 攻击的风险，请将其设置为 'html'。</p>
</li>
<li>
<p><code>grails.views.gsp.encoding</code> - 用于 GSP 源文件的文件编码（默认值：“utf-8”）。</p>
</li>
<li>
<p><code>grails.mime.file.extensions</code> - 是否使用文件扩展名指定链接中的 mime 类型 <a href="theWebLayer.html#contentNegotiation">Content Negotiation</a>（默认值：true）。</p>
</li>
<li>
<p><code>grails.mime.types</code> - 用于 <a href="theWebLayer.html#contentNegotiation">Content Negotiation</a> 的受支持 mime 类型的映射。</p>
</li>
<li>
<p><code>grails.server URL</code> - 指定绝对链接的服务器URL部分的字符串，包括服务器名，例如 grails.serverURL="http://my.yourportal.com"。查看 <a href="http://gsp.grails.org/latest/ref/Tags/createLink.html">createLink</a>。也被重定向使用。</p>
</li>
<li>
<p><code>grails.views.gsp.sitemesh.preprocess</code> - 决定是否进行 sitemesh 预处理。禁用此选项会减慢页面呈现速度，但如果需要 SiteMesh 从 GSP 视图解析生成的 HTML，则禁用它是正确的选项。如果您不了解此高级属性，请不要担心：将其设置为 true。</p>
</li>
<li>
<p><code>grails.reload.excludes</code> 和 <code>grails.reload.includes</code> - 配置这些指令将确定项目特定源文件的重新加载行为。每个指令都有一个字符串列表，这些字符串是项目源文件的类名，在使用 <code>run app</code> 命令运行开发中的应用程序时，这些字符串应排除在重新加载行为之外，或相应地包含在其中。如果配置了 <code>grails.reload.includes</code> 指令，则只会重新加载该列表中的类。</p>
</li>
</ul>
</div>
</div>

<a name="3.1.2 &#26085;&#24535;"><!-- Legacy link --></a>
<h2 id="logging">4.1.3 日志</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/logging.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>默认情况下，Grails 3.0 中的日志记录由 <a href="http://logback.qos.ch">Logback日志记录框架</a> 处理，并且可以使用 <code>grails-app/conf/logback.groovy</code> 文件进行配置。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
如果您更喜欢XML，则可以将 <code>logback.groovy `文件替换为 `logback.xml</code> 文件。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>有关配置日志记录的更多信息，请参阅关于该主题的 <a href="http://logback.qos.ch/manual/groovy.html">Logback文档</a>。</p>
</div>


<h2 id="loggerName">4.1.3.1 记录器名称</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/logging/loggerName.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails artifacts（Grails 工件：控制器、服务…）会自动注入一个 log 属性。</p>
</div>
<div class="paragraph">
<p>在 Grails 3.3.0 之前, Grails Artifact 的 logger 遵循惯例 <code>grails.app.&lt;type&gt;.&lt;className&gt;</code>，其中 type 是工件的类型，例如 <code>controllers</code> 或 <code>services</code>，<code>className</code> 是工件的完全限定名。</p>
</div>
<div class="paragraph">
<p>Grails 3.3.x 简化了 logger 名称。下面的示例说明了这些更改：</p>
</div>
<div class="paragraph">
<p><code>BookController.groovy</code> 位于 <code>grails app/controllers/com/company</code> ，没有使用 <code><a href="http://docs.groovy-lang.org/latest/html/gapi/groovy/util/logging/Slf4j.html">@Slf4j</a></code> 注释：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.3.x or higher)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.2.x or lower)</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookController</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grails.app.controllers.com.company.BookController</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>BookController.groovy</code> 位于 <code>grails app/controllers/com/company</code> ，注释为 <code><a href="http://docs.groovy-lang.org/latest/html/gapi/groovy/util/logging/Slf4j.html">@Slf4j</a></code> ：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.3.x or higher)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.2.x or lower)</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookController</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookController</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>BookService.groovy</code> 位于 <code>grails app/services/com/company</code> ，没有使用 <code><a href="http://docs.groovy-lang.org/latest/html/gapi/groovy/util/logging/Slf4j.html">@Slf4j</a></code> 注释：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.3.x or higher)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.2.x or lower)</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>grails.app.services.com.company.BookService</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>BookService.groovy</code> 位于 <code>grails app/services/com/company</code> ，注释为 <code><a href="http://docs.groovy-lang.org/latest/html/gapi/groovy/util/logging/Slf4j.html">@Slf4j</a></code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.3.x or higher)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.2.x or lower)</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookService</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookService</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><code>BookDetail.groovy</code> 位于 <code>src/main/groovy/com/company</code> ，注释为 <code><a href="http://docs.groovy-lang.org/latest/html/gapi/groovy/util/logging/Slf4j.html">@Slf4j</a></code></p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.3.x or higher)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Logger Name (Grails 3.2.x or lower)</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookDetail</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>com.company.BookDetail</code></p></td>
</tr>
</tbody>
</table>


<h2 id="maskingRequestParametersFromStacktraceLogs">4.1.3.2 从堆栈跟踪日志屏蔽请求参数</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/logging/maskingRequestParametersFromStacktraceLogs.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>当 Grails 记录堆栈跟踪（stacktrace）时，日志消息可能包含当前请求的所有请求参数的名称和值。</p>
</div>
<div class="paragraph">
<p>要屏蔽安全请求参数的值，请在 <code>grails.exceptionresolver.params.exclude</code> 配置属性中指定参数名称：</p>
</div>
<div class="listingblock">
<div class="title">grails-app/conf/application.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">exceptionresolver</span>:
        <span class="key">params</span>:
            <span class="key">exclude</span>:
                - <span class="string"><span class="content">password</span></span>
                - <span class="string"><span class="content">creditCard</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>通过将 <code>grails.exceptionresolver.logRequestParameters</code> 配置属性设置为 false，可以完全关闭请求参数日志记录。</p>
</div>
<div class="paragraph">
<p>当应用程序在开发模式（DEVELOPMENT MODE）下运行时，默认值为 true，对于应用程序的其他所有环境，默认值为 false。</p>
</div>
<div class="listingblock">
<div class="title">grails-app/conf/application.yaml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">exceptionresolver</span>:
        <span class="key">logRequestParameters</span>: <span class="string"><span class="content">false</span></span></code></pre>
</div>
</div>


<h2 id="externalLoggingConfiguration">4.1.3.3 外部配置文件</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/logging/externalLoggingConfiguration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如果设置配置属性 <code>logging.config</code>，则可以通知 Logback 使用外部配置文件。</p>
</div>
<div class="listingblock">
<div class="title">grails-app/conf/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">logging</span>:
    <span class="key">config</span>: <span class="string"><span class="content">/Users/me/config/logback.groovy</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>或者，可以通过配置系统属性的方式提供配置文件位置：</p>
</div>
<div class="paragraph">
<p><code>$ ./gradlew -Dlogging.config=/Users/me/config/logback.groovy bootRun</code></p>
</div>
<div class="paragraph">
<p>或者，还可以使用环境变量：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ export LOGGING_CONFIG=/Users/me/config/logback.groovy
$ ./gradlew bootRun</code></pre>
</div>
</div>

<a name="3.1.3 GORM"><!-- Legacy link --></a>
<h2 id="configGORM">4.1.4 GORM</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/configGORM.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails 提供了以下 GORM 配置选项:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails.gorm.failOnError</code> - 如果设置为 <code>true</code> ，则会导致域类上的 <code>save()</code> 方法在 <a href="validation.html">validation</a> 失败时抛出 <code>grails.validation.ValidationException</code> 。也可以为该选项分配表示包名称的字符串列表。如果值是字符串列表，则 failOnError 行为将仅应用于这些包（包括子包）中的域类。有关更多详细信息，请参阅 <a href="../ref/Domain%20Classes/save.html">save</a> 文档。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>例如，要为所有域类启用 failOnError：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">failOnError</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>以及要按包为域类启用 failOnError：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">gorm</span>:
        <span class="key">failOnError</span>:
            - <span class="string"><span class="content">com.companyname.somepackage</span></span>
            - <span class="string"><span class="content">com.companyname.someotherpackage</span></span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails.gorm.autoFlush</code> - 如果设置为 <code>true</code> ,将导致 <a href="../ref/Domain%20Classes/merge.html">merge</a> 、 <a href="../ref/Domain%20Classes/save.html">save</a> 和 <a href="../ref/Domain%20Classes/delete.html">delete</a> 方法刷新会话，替换使用 <code>save(flush:true)</code> 显式刷新的需要。</p>
</li>
</ul>
</div>


<h2 id="proxyConfig">4.1.5 配置 HTTP 代理</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/config/proxyConfig.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>要将 Grails 设置为使用 HTTP 代理，有两个步骤。首先，如果您想使用它来创建应用程序，则需要配置 <code>grails</code> CLI以了解代理。可以使用 <code>GRAILS_OPTS</code> 环境变量来完成，例如在 Unix 系统上：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">export GRAILS_OPTS=&quot;-Dhttps.proxyHost=127.0.0.1 -Dhttps.proxyPort=3128 -Dhttp.proxyUser=test -Dhttp.proxyPassword=test&quot;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
默认的配置文件存储库是通过HTTPS解析的，因此使用 <code>https.proxyPort</code> 和 <code>https.proxyUser</code> ，但是用户名和密码是通过 <code>http.proxyUser</code> 和 <code>http.proxyPassword</code> 指定的。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>对于 Windows 系统，可以在 "我的电脑/高级/环境变量" 下配置环境变量。</p>
</div>
<div class="paragraph">
<p>有了这种配置，<code>grails</code> 命令就可以通过代理进行连接和认证。</p>
</div>
<div class="paragraph">
<p>其次，由于 Grails 使用 Gradle 作为构建系统，因此您需要将 Gradle 配置为通过代理进行身份验证。有关如何执行此操作的说明，请参阅 <a href="https://docs.gradle.org/current/userguide/build_environment.html#sec:accessing_the_web_via_a_proxy">该主题的Gradle用户指南部分</a>。</p>
</div>


<h2 id="applicationClass">4.2 应用程序类</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/applicationClass.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>每个新的 Grails 应用程序都在 grails-app/init 目录中具有一个 Application 类。</p>
</div>
<div class="paragraph">
<p><code>Application</code> 类是 <a href="http://docs.grails.org/4.0.0/api/grails/boot/config/GrailsAutoConfiguration.html">GrailsAutoConfiguration</a> 类，并具有静态无返回值 main 方法，这意味着它可以作为常规应用程序运行。</p>
</div>


<h2 id="executing">4.2.1 执行应用程序类</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/applicationClass/executing.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>有几种方法可以执行 <code>Application</code> 类，如果您使用的是 IDE，那么您只需右键单击该类并直接从 IDE 运行它，IDE 将启动 Grails 应用程序。</p>
</div>
<div class="paragraph">
<p>这对于调试也很有用，因为可以使用 <code>run-app --debug-jvm</code> 命令行中的命令。</p>
</div>
<div class="paragraph">
<p>您还可以将应用程序打包为可运行的WAR文件，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails package
$ java -jar build/libs/myapp-0.1.war</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您计划使用无容器（container-less）方法部署应用程序，这将非常有用。</p>
</div>


<h2 id="customizing">4.2.2 自定义应用程序类</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/applicationClass/customizing.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>您可以通过多种方式自定义 <code>Application</code> 类。</p>
</div>
<div class="sect2">
<h3 id="_总定义扫描路径">总定义扫描路径</h3>
<div class="paragraph">
<p>默认情况下，Grails 会扫描所有已知的源目录中的控制器、域类等，但是，如果您希望扫描其他JAR文件中的软件包，则可以通过覆盖 <code>Application</code> 类的 <code>packageNames()</code> 方法来进行扫描：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Application</span> <span class="directive">extends</span> GrailsAutoConfiguration {
    <span class="annotation">@Override</span>
    <span class="predefined-type">Collection</span>&lt;<span class="predefined-type">String</span>&gt; packageNames() {
        <span class="local-variable">super</span>.packageNames() + [<span class="string"><span class="delimiter">'</span><span class="content">my.additional.package</span><span class="delimiter">'</span></span>]
    }

    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_注册其他bean">注册其他Bean</h3>
<div class="paragraph">
<p><code>Application</code> 类也可以用作 Spring bean 定义的源代码，只需定义一个用 <a href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/context/annotation/Bean.html">Bean</a> 注释的方法，返回的对象将成为 Spring bean 。 该方法的名称用作Bean名称：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Application</span> <span class="directive">extends</span> GrailsAutoConfiguration {
    <span class="annotation">@Bean</span>
    MyType myBean() {
        <span class="keyword">return</span> <span class="keyword">new</span> MyType()
    }

    ...
}</code></pre>
</div>
</div>
</div>


<h2 id="applicationLifeCycle">4.2.3 应用程序生命周期</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/applicationClass/applicationLifeCycle.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><code>Application</code> 类还实现了所有插件都实现的 <a href="http://docs.grails.org/4.0.0/api/grails/core/GrailsApplicationLifeCycle.html">GrailsApplicationLifeCycle</a> 接口。</p>
</div>
<div class="paragraph">
<p>这意味着 <code>Application</code> 类可用于执行与插件相同的功能。您可以通过覆盖适当的方法来覆盖 <a href="plugins.html#hookingIntoRuntimeConfiguration">regular plugins hooks</a> ，例如 <code>doWithSpring</code> ，<code>doWithApplicationContext</code> 等。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Application</span> <span class="directive">extends</span> GrailsAutoConfiguration {
    <span class="annotation">@Override</span>
    Closure doWithSpring() {
        {-&gt;
            mySpringBean(MyType)
        }
    }

    ...
}</code></pre>
</div>
</div>

<a name="3.2 &#29615;&#22659;"><!-- Legacy link --></a>
<h2 id="environments">4.3 环境</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/environments.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect2">
<h3 id="_每个环境独立配置">每个环境独立配置</h3>
<div class="paragraph">
<p>Grails 支持每个环境配置的概念。 <code>grails-app/conf</code> 目录中的 <code>application.yml</code> 和 <code>application.groovy</code> 文件可以使用每个环境的配置，使用 YAML 或 <a href="http://docs.groovy-lang.org/latest/html/documentation/＃_configslurper">ConfigSlurper</a> 提供的语法。作为示例，请考虑 Grails 提供的以下默认 <code>application.yml</code> 定义：</p>
</div>
<div class="listingblock">
<div class="content">
<pre>environments:
    development:
        dataSource:
            dbCreate: create-drop
            url: jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE
    test:
        dataSource:
            dbCreate: update
            url: jdbc:h2:mem:testDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE
    production:
        dataSource:
            dbCreate: update
            url: jdbc:h2:prodDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE
        properties:
           jmxEnabled: true
           initialSize: 5
        ...</pre>
</div>
</div>
<div class="paragraph">
<p>以上内容可以在 <code>application.groovy</code> 中的 Groovy 语法中表示如下：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dataSource {
    pooled = <span class="predefined-constant">false</span>
    driverClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">org.h2.Driver</span><span class="delimiter">&quot;</span></span>
    username = <span class="string"><span class="delimiter">&quot;</span><span class="content">sa</span><span class="delimiter">&quot;</span></span>
    password = <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>
}
environments {
    development {
        dataSource {
            dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">create-drop</span><span class="delimiter">&quot;</span></span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:h2:mem:devDb</span><span class="delimiter">&quot;</span></span>
        }
    }
    test {
        dataSource {
            dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:h2:mem:testDb</span><span class="delimiter">&quot;</span></span>
        }
    }
    production {
        dataSource {
            dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span>
            url = <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:h2:prodDb</span><span class="delimiter">&quot;</span></span>
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意如何在顶层提供通用配置，然后一个 <code>environments</code> 块为每个环境设置指定 <code>DataSource</code> 的 <code>dbCreate</code> 和 <code>url</code> 属性。</p>
</div>
</div>
<div class="sect2">
<h3 id="_不同环境下的打包和运行">不同环境下的打包和运行</h3>
<div class="paragraph">
<p>Grails 的 <a href="commandLine.html">command line</a> 具有内置功能，可以在特定环境的上下文中执行任何命令。格式为：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">grails &lt;&lt;environment&gt;&gt; &lt;&lt;command name&gt;&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>另外，Grails 已知 3 种预设环境：<code>dev</code>、<code>prod</code> 和 <code>test</code> 用于 <code>开发环境</code>、<code>生产环境</code> 和 <code>测试环境</code> 。例如，要为 <code>test</code> 环境创建 WAR，您将运行：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">grails test war</code></pre>
</div>
</div>
<div class="paragraph">
<p>要定位其他环境，可以将 <code>grails.env</code> 变量传递给任何命令：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">grails -Dgrails.env=UAT run-app</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_程序环境检测">程序环境检测</h3>
<div class="paragraph">
<p>在代码中，例如在 Gant 脚本或引导程序类中，您可以使用 <a href="http://docs.grails.org/4.0.0/api/grails/util/Environment.html">Environment</a> 类来检测环境：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.util.Environment</span>

...

switch (Environment.current) {
    <span class="keyword">case</span> Environment.DEVELOPMENT:
        configureForDevelopment()
        <span class="keyword">break</span>
    <span class="keyword">case</span> Environment.PRODUCTION:
        configureForProduction()
        <span class="keyword">break</span>
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_每个环境引导">每个环境引导</h3>
<div class="paragraph">
<p>当您的应用程序基于每个环境启动时，通常希望运行代码。为此，您可以使用 <code>grails-app/init/BootStrap.groovy</code> 文件对每个环境的执行的支持：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> init = { ServletContext ctx -&gt;
    environments {
        production {
            ctx.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">env</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">prod</span><span class="delimiter">&quot;</span></span>)
        }
        development {
            ctx.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">env</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">dev</span><span class="delimiter">&quot;</span></span>)
        }
    }
    ctx.setAttribute(<span class="string"><span class="delimiter">&quot;</span><span class="content">foo</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">bar</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_每个环境通用的执行">每个环境通用的执行</h3>
<div class="paragraph">
<p>前面的 <code>BootStrap</code> 示例内部使用了 <code>grails.util.Environment</code> 类来执行。您还可以自己使用此类来执行自己的环境特定逻辑：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">Environment.executeForCurrentEnvironment {
    production {
        <span class="comment">// do something in production</span>
    }
    development {
        <span class="comment">// do something only in development</span>
    }
}</code></pre>
</div>
</div>
</div>

<a name="3.3 &#25968;&#25454;&#28304;"><!-- Legacy link --></a>
<h2 id="dataSource">4.4 数据源</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dataSource.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>由于 Grails 是基于 Java 技术建立的，因此设置数据源需要 JDBC 的一些知识（JDBC 是 Java Database Connectivity 的缩写）。</p>
</div>
<div class="paragraph">
<p>如果使用 H2 以外的数据库，则需要 JDBC 驱动程序。 例如对于 MySQL，您将需要 <a href="http://www.mysql.com/downloads/connector/j/">Connector/J</a> 。</p>
</div>
<div class="paragraph">
<p>驱动程序通常以 JAR 存档的形式出现。最好使用依赖项解析来解析 jar（如果它在 Maven 存储库中可用），例如，您可以为 MySQL 驱动程序添加依赖项，如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    runtime <span class="string"><span class="delimiter">'</span><span class="content">mysql:mysql-connector-java:5.1.29</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>解决 JAR 问题后，您需要熟悉 Grails 如何管理其数据库配置。可以在 <code>grails-app/conf/application.groovy</code> 或 <code>grails-app/conf/application.yml</code> 中维护配置。这些文件包含 dataSource 定义，其中包括以下设置：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>driverClassName</code> - JDBC 驱动程序的类名</p>
</li>
<li>
<p><code>username</code> - 用于建立 JDBC 连接的用户名</p>
</li>
<li>
<p><code>password</code> - 用于建立 JDBC 连接的密码</p>
</li>
<li>
<p><code>url</code> - 数据库的 JDBC URL</p>
</li>
<li>
<p><code>dbCreate</code> - 是否从域模型自动生成数据库 - 'create-drop'，'create'，'update' 或 'validate' 之一</p>
</li>
<li>
<p><code>pooled</code> - 是否使用连接池（默认为 true）</p>
</li>
<li>
<p><code>logSql</code> - 启用 SQL 记录到标准输出</p>
</li>
<li>
<p><code>formatSql</code> - 格式化记录的 SQL</p>
</li>
<li>
<p><code>dialect</code> - 一个字符串或类，表示用于与数据库进行通信的 Hibernate 语言。有关可用的语言，请参见 <a href="http://docs.jboss.org/hibernate/core/3.6/javadocs/org/hibernate/dialect/package-summary.html">org.hibernate.dialect</a> 程序包。</p>
</li>
<li>
<p><code>readOnly</code> - 如果 <code>true</code> 使数据源为只读，则导致连接池在每个 <code>Connection</code> 上调用 <code>setReadOnly（true）</code> 。</p>
</li>
<li>
<p><code>transactional</code> - 如果 <code>false</code> 将 DataSource 的 transactionManager bean 留在链式 BE1PC 事务管理器实现之外。这仅适用于其他数据源。</p>
</li>
<li>
<p><code>persistenceInterceptor</code> - 默认数据源自动连接到持久性拦截器，其他数据源不自动连接，除非将其设置为 <code>true</code></p>
</li>
<li>
<p><code>properties</code> - 在 DataSource bean 上设置的额外属性。请参阅 <a href="http://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html#Common_Attributes">Tomcat Pool</a> 文档。还有Javadoc格式的 <a href="https://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/tomcat/jdbc/pool/PoolConfiguration.html">documentation of the properties</a> 。</p>
</li>
<li>
<p><code>jmxExport</code> - 如果为 <code>false</code> ，将禁用所有数据源的 JMX MBean 注册。默认情况下，为属性中的 <code>jmxEnabled = true</code> 的数据源添加 JMX MBean。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>在 application.groovy 中，MySQL 的典型配置可能类似于：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dataSource {
    pooled = <span class="predefined-constant">true</span>
    dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span>
    url = <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:mysql://localhost:3306/my_database</span><span class="delimiter">&quot;</span></span>
    driverClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">com.mysql.jdbc.Driver</span><span class="delimiter">&quot;</span></span>
    dialect = org.hibernate.dialect.MySQL5InnoDBDialect
    username = <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>
    password = <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
    properties {
       jmxEnabled = <span class="predefined-constant">true</span>
       initialSize = <span class="integer">5</span>
       maxActive = <span class="integer">50</span>
       minIdle = <span class="integer">5</span>
       maxIdle = <span class="integer">25</span>
       maxWait = <span class="integer">10000</span>
       maxAge = <span class="integer">10</span> * <span class="integer">60000</span>
       timeBetweenEvictionRunsMillis = <span class="integer">5000</span>
       minEvictableIdleTimeMillis = <span class="integer">60000</span>
       validationQuery = <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT 1</span><span class="delimiter">&quot;</span></span>
       validationQueryTimeout = <span class="integer">3</span>
       validationInterval = <span class="integer">15000</span>
       testOnBorrow = <span class="predefined-constant">true</span>
       testWhileIdle = <span class="predefined-constant">true</span>
       testOnReturn = <span class="predefined-constant">false</span>
       jdbcInterceptors = <span class="string"><span class="delimiter">&quot;</span><span class="content">ConnectionState;StatementCache(max=200)</span><span class="delimiter">&quot;</span></span>
       defaultTransactionIsolation = java.sql.Connection.TRANSACTION_READ_COMMITTED
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
在配置数据源时，请不要在任何配置设置之前包含 type 或 def 关键字，因为 Groovy 会将其视为本地变量定义，并且将不对其进行处理。例如，以下内容无效：
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dataSource {
    <span class="type">boolean</span> pooled = <span class="predefined-constant">true</span> <span class="comment">// type declaration results in ignored local variable</span>
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>使用额外属性的高级配置示例：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dataSource {
    pooled = <span class="predefined-constant">true</span>
    dbCreate = <span class="string"><span class="delimiter">&quot;</span><span class="content">update</span><span class="delimiter">&quot;</span></span>
    url = <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:mysql://localhost:3306/my_database</span><span class="delimiter">&quot;</span></span>
    driverClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">com.mysql.jdbc.Driver</span><span class="delimiter">&quot;</span></span>
    dialect = org.hibernate.dialect.MySQL5InnoDBDialect
    username = <span class="string"><span class="delimiter">&quot;</span><span class="content">username</span><span class="delimiter">&quot;</span></span>
    password = <span class="string"><span class="delimiter">&quot;</span><span class="content">password</span><span class="delimiter">&quot;</span></span>
    properties {
       <span class="comment">// Documentation for Tomcat JDBC Pool</span>
       <span class="comment">// http://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html#Common_Attributes</span>
       <span class="comment">// https://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/tomcat/jdbc/pool/PoolConfiguration.html</span>
       jmxEnabled = <span class="predefined-constant">true</span>
       initialSize = <span class="integer">5</span>
       maxActive = <span class="integer">50</span>
       minIdle = <span class="integer">5</span>
       maxIdle = <span class="integer">25</span>
       maxWait = <span class="integer">10000</span>
       maxAge = <span class="integer">10</span> * <span class="integer">60000</span>
       timeBetweenEvictionRunsMillis = <span class="integer">5000</span>
       minEvictableIdleTimeMillis = <span class="integer">60000</span>
       validationQuery = <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT 1</span><span class="delimiter">&quot;</span></span>
       validationQueryTimeout = <span class="integer">3</span>
       validationInterval = <span class="integer">15000</span>
       testOnBorrow = <span class="predefined-constant">true</span>
       testWhileIdle = <span class="predefined-constant">true</span>
       testOnReturn = <span class="predefined-constant">false</span>
       ignoreExceptionOnPreLoad = <span class="predefined-constant">true</span>
       <span class="comment">// http://tomcat.apache.org/tomcat-7.0-doc/jdbc-pool.html#JDBC_interceptors</span>
       jdbcInterceptors = <span class="string"><span class="delimiter">&quot;</span><span class="content">ConnectionState;StatementCache(max=200)</span><span class="delimiter">&quot;</span></span>
       defaultTransactionIsolation = java.sql.Connection.TRANSACTION_READ_COMMITTED <span class="comment">// safe default</span>
       <span class="comment">// controls for leaked connections</span>
       abandonWhenPercentageFull = <span class="integer">100</span> <span class="comment">// settings are active only when pool is full</span>
       removeAbandonedTimeout = <span class="integer">120</span>
       removeAbandoned = <span class="predefined-constant">true</span>
       <span class="comment">// use JMX console to change this setting at runtime</span>
       logAbandoned = <span class="predefined-constant">false</span> <span class="comment">// causes stacktrace recording overhead, use only for debugging</span>
       <span class="comment">// JDBC driver properties</span>
       <span class="comment">// Mysql as example</span>
       dbProperties {
           <span class="comment">// Mysql specific driver properties</span>
           <span class="comment">// http://dev.mysql.com/doc/connector-j/en/connector-j-reference-configuration-properties.html</span>
           <span class="comment">// let Tomcat JDBC Pool handle reconnecting</span>
           autoReconnect=<span class="predefined-constant">false</span>
           <span class="comment">// truncation behaviour</span>
           jdbcCompliantTruncation=<span class="predefined-constant">false</span>
           <span class="comment">// mysql 0-date conversion</span>
           zeroDateTimeBehavior=<span class="string"><span class="delimiter">'</span><span class="content">convertToNull</span><span class="delimiter">'</span></span>
           <span class="comment">// Tomcat JDBC Pool's StatementCache is used instead, so disable mysql driver's cache</span>
           cachePrepStmts=<span class="predefined-constant">false</span>
           cacheCallableStmts=<span class="predefined-constant">false</span>
           <span class="comment">// Tomcat JDBC Pool's StatementFinalizer keeps track</span>
           dontTrackOpenResources=<span class="predefined-constant">true</span>
           <span class="comment">// performance optimization: reduce number of SQLExceptions thrown in mysql driver code</span>
           holdResultsOpenOverStatementClose=<span class="predefined-constant">true</span>
           <span class="comment">// enable MySQL query cache - using server prep stmts will disable query caching</span>
           useServerPrepStmts=<span class="predefined-constant">false</span>
           <span class="comment">// metadata caching</span>
           cacheServerConfiguration=<span class="predefined-constant">true</span>
           cacheResultSetMetadata=<span class="predefined-constant">true</span>
           metadataCacheSize=<span class="integer">100</span>
           <span class="comment">// timeouts for TCP/IP</span>
           connectTimeout=<span class="integer">15000</span>
           socketTimeout=<span class="integer">120000</span>
           <span class="comment">// timer tuning (disable)</span>
           maintainTimeStats=<span class="predefined-constant">false</span>
           enableQueryTimeouts=<span class="predefined-constant">false</span>
           <span class="comment">// misc tuning</span>
           noDatetimeStringSync=<span class="predefined-constant">true</span>
       }
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_有关_dbcreate_的更多信息">有关 dbCreate 的更多信息</h4>
<div class="paragraph">
<p>Hibernate 可以自动创建您的域模型所需的数据库表。您可以通过 dbCreate 属性控制何时以及如何执行此操作，该属性可以采用以下值：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>create</strong> - 删除现有架构并在启动时创建架构，首先删除现有表，索引等。</p>
</li>
<li>
<p><strong>create-drop</strong> - 与 create 相同，但是在应用程序完全关闭时也会删除表。</p>
</li>
<li>
<p><strong>update</strong> - 创建丢失的表和索引，并在不删除任何表或数据的情况下更新当前架构。请注意，这无法正确处理许多架构更改，例如列重命名（剩下的旧列包含现有数据）。</p>
</li>
<li>
<p><strong>validate</strong> - 不更改数据库。将配置与现有数据库架构进行比较，并报告警告。</p>
</li>
<li>
<p>any other value - 不执行任何操作</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>一旦您的模式相对稳定，并且建议将应用程序和数据库部署在生产环境中时，建议将 <code>dbCreate</code> 设置为 "none" 。 然后，使用SQL脚本或诸如 <a href="https://flywaydb.org/">Flyway</a> 或 <a href="http://www.liquibase.org/">Liquibase</a> 之类的迁移工具，通过适当的迁移来管理数据库更改。 <a href="http://plugins.grails.org/plugin/grails/database-migration">DatabaseMigration</a> 插件使用 Liquibase 。</p>
</div>
</div>

<a name="3.3.1 &#25968;&#25454;&#28304;&#21644;&#29615;&#22659;"><!-- Legacy link --></a>
<h2 id="dataSourcesAndEnvironments">4.4.1 数据源和环境</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dataSource/dataSourcesAndEnvironments.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>前面的示例配置假定您在所有环境（生产、测试、开发等）下都需要相同的配置。</p>
</div>
<div class="paragraph">
<p>但是，Grails的DataSource 定义是 "环境感知的(environment aware)"，因此您可以执行以下操作:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dataSource {
    pooled = <span class="predefined-constant">true</span>
    driverClassName = <span class="string"><span class="delimiter">&quot;</span><span class="content">com.mysql.jdbc.Driver</span><span class="delimiter">&quot;</span></span>
    dialect = org.hibernate.dialect.MySQL5InnoDBDialect
    <span class="comment">// other common settings here</span>
}

environments {
    production {
        dataSource {
            url = <span class="string"><span class="delimiter">&quot;</span><span class="content">jdbc:mysql://liveip.com/liveDb</span><span class="delimiter">&quot;</span></span>
            <span class="comment">// other environment-specific settings here</span>
        }
    }
}</code></pre>
</div>
</div>

<a name="3.3.3 &#33258;&#21160;&#25968;&#25454;&#24211;&#36801;&#31227;"><!-- Legacy link --></a>
<h2 id="automaticDatabaseMigration">4.4.2 自动数据库迁移</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dataSource/automaticDatabaseMigration.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><code>DataSource</code> 定义的 <code>dbCreate</code> 属性很重要，因为它指示 Grails 在运行时应该如何从 <a href="GORM.html">GORM</a> 类自动生成数据库表。这些选项在 <a href="#dataSource">DataSource</a> 部分中进行了描述：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>create</code></p>
</li>
<li>
<p><code>create-drop</code></p>
</li>
<li>
<p><code>update</code></p>
</li>
<li>
<p><code>validate</code></p>
</li>
<li>
<p>no value</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>在 <a href="#environments">development</a> 模式下，默认将 <code>dbCreate</code> 设置为 “create-drop”，但是在开发的某个时刻（比如一旦进入生产阶段）您需要停止每次启动服务器时都删除并重新创建数据库。</p>
</div>
<div class="paragraph">
<p>尝试变更为 <code>update</code> 看起来很美好，因为您保留了现有数据并且仅在代码更改时才更新架构，但是 Hibernate 的更新支持非常保守。它不会进行任何可能导致数据丢失的更改，并且不会检测到重命名的列或表，因此您将继续拥有旧的列或表，并且还将同时拥有新的列或表。</p>
</div>
<div class="paragraph">
<p>Grails 支持通过使用 Liquibase 插件或 Flyway 插件进行迁移。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://plugins.grails.org/plugin/grails/database-migration">Database Migration</a></p>
</li>
<li>
<p><a href="http://plugins.grails.org/plugin/saw303/org.grails.plugins%3Agrails-flyway">Flyway</a></p>
</li>
</ul>
</div>

<a name="3.3.4 &#20107;&#21153;&#24863;&#30693;&#25968;&#25454;&#28304;&#20195;&#29702;"><!-- Legacy link --></a>
<h2 id="transactionAwareDataSourceProxy">4.4.3 事务感知数据源代理</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dataSource/transactionAwareDataSourceProxy.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>实际的 <code>dataSource</code> bean 被包装在一个可识别事务的代理中，因此将为您提供当前事务或 Hibernate <code>Session</code> （如果一个处于活动状态）正在使用的连接。</p>
</div>
<div class="paragraph">
<p>如果不是这种情况，那么从 <code>dataSource</code> 中检索连接将是一个新的连接，并且您将无法看到尚未提交的更改（假设您具有合理的事务隔离设置，例如 <code>READ_COMMITTED</code> 或更高）。</p>
</div>
<div class="paragraph">
<p>如果需要访问，仍然可以使用 "真实的" 未代理的 <code>dataSource</code> 。它的bean名称是 <code>dataSourceUnproxied</code> 。</p>
</div>
<div class="paragraph">
<p>您可以像使用其他任何 Spring bean 一样访问此 bean，即使用依赖注入：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">MyService</span> {

   <span class="keyword">def</span> dataSourceUnproxied
   ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>或从 <code>ApplicationContext</code> 中将其拉出：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> dataSourceUnproxied = ctx.dataSourceUnproxied</code></pre>
</div>
</div>

<a name="3.3.5 &#25968;&#25454;&#24211;&#25511;&#21046;&#21488;"><!-- Legacy link --></a>
<h2 id="databaseConsole">4.4.4 数据库控制台</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dataSource/databaseConsole.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://h2database.com/html/quickstart.html#h2_console">H2数据库控制台</a> 是 H2 的一项便利功能，它为您拥有 JDBC 驱动程序的任何数据库提供了基于 Web 的界面，对于查看您要开发的数据库。当针对内存数据库运行时，它特别有用。</p>
</div>
<div class="paragraph">
<p>您可以通过在浏览器中导航到 <a href="http://localhost:8080/dbconsole" class="bare">http://localhost:8080/dbconsole</a> 来访问控制台。可以使用 <code>application.groovy</code> 中的 <code>grails.dbconsole.urlRoot</code> 属性来配置URI，默认为 <code>/dbconsole</code>。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
目前已经变更为 <code>/h2-console</code>。by <a href="http://www.micrograils.com">MicroGrails</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>默认情况下，控制台在开发模式下处于启用状态，可以通过使用 <code>application.groovy</code> 中的 <code>grails.dbconsole.enabled</code> 属性来禁用或启用该控制台。例如，您可以这样在生产环境中启用控制台：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">environments {
    production {
        grails.serverURL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.changeme.com</span><span class="delimiter">&quot;</span></span>
        grails.dbconsole.enabled = <span class="predefined-constant">true</span>
        grails.dbconsole.urlRoot = <span class="string"><span class="delimiter">'</span><span class="content">/admin/dbconsole</span><span class="delimiter">'</span></span>
    }
    development {
        grails.serverURL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/</span><span class="inline"><span class="inline-delimiter">${</span>appName<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
    test {
        grails.serverURL = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/</span><span class="inline"><span class="inline-delimiter">${</span>appName<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
如果在生产环境中启用了控制台，请确保使用受信任的安全框架来保护对控制台的访问。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_配置">配置</h4>
<div class="paragraph">
<p>默认情况下，控制台配置为H2数据库，如果您尚未配置外部数据库，则该控制台将使用默认设置工作-您只需要将 JDBC URL 更改为 <code>jdbc:h2:mem:devDb</code>。如果您已经配置了外部数据库（例如 MySQL，Oracle 等），则可以使用"保存的设置"下拉列表选择设置模板，然后从 <code>application.groovy</code> 中填写url和用户名/密码信息。</p>
</div>
</div>

<a name="3.3.6 &#22810;&#20010;&#25968;&#25454;&#28304;"><!-- Legacy link --></a>
<h2 id="multipleDatasources">4.4.5 多个数据源</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dataSource/multipleDatasources.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>默认情况下，所有域类共享一个 <code>DataSource</code> 和一个数据库，但是您可以选择将域类划分为两个或多个数据源。</p>
</div>
<div class="sect3">
<h4 id="_配置其他数据源">配置其他数据源</h4>
<div class="paragraph">
<p><code>grails-app/conf/application.yml</code> 中的默认 <code>DataSource</code> 配置如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">dataSource</span>:
    <span class="key">pooled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">jmxExport</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">driverClassName</span>: <span class="string"><span class="content">org.h2.Driver</span></span>
    <span class="key">username</span>: <span class="string"><span class="content">sa</span></span>
    <span class="key">password</span>:

<span class="key">environments</span>:
    <span class="key">development</span>:
        <span class="key">dataSource</span>:
            <span class="key">dbCreate</span>: <span class="string"><span class="content">create-drop</span></span>
            <span class="key">url</span>: <span class="string"><span class="content">jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE</span></span>
    <span class="key">test</span>:
        <span class="key">dataSource</span>:
            <span class="key">dbCreate</span>: <span class="string"><span class="content">update</span></span>
            <span class="key">url</span>: <span class="string"><span class="content">jdbc:h2:mem:testDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE</span></span>
    <span class="key">production</span>:
        <span class="key">dataSource</span>:
            <span class="key">dbCreate</span>: <span class="string"><span class="content">update</span></span>
            <span class="key">url</span>: <span class="string"><span class="content">jdbc:h2:prodDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE</span></span>
            <span class="key">properties</span>:
               <span class="key">jmxEnabled</span>: <span class="string"><span class="content">true</span></span>
               <span class="key">initialSize</span>: <span class="string"><span class="content">5</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>这将使用名为 <code>dataSource</code> 的 Spring bean 配置单个 <code>DataSource</code> 。要配置额外的数据源，请添加一个带有自定义名称的 <code>dataSources</code> 块（放在顶层，或在一个环境块中，或两者都在，就像标准的 <code>DataSource</code> 定义一样）。例如，下面配置添加了第二个 <code>DataSource</code> ，在开发环境中使用 MySQL，在生产环境中使用 Oracle：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">dataSource</span>:
    <span class="key">pooled</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">jmxExport</span>: <span class="string"><span class="content">true</span></span>
    <span class="key">driverClassName</span>: <span class="string"><span class="content">org.h2.Driver</span></span>
    <span class="key">username</span>: <span class="string"><span class="content">sa</span></span>
    <span class="key">password</span>:

<span class="key">dataSources</span>:
    <span class="key">lookup</span>:
        <span class="key">dialect</span>: <span class="string"><span class="content">org.hibernate.dialect.MySQLInnoDBDialect</span></span>
        <span class="key">driverClassName</span>: <span class="string"><span class="content">com.mysql.jdbc.Driver</span></span>
        <span class="key">username</span>: <span class="string"><span class="content">lookup</span></span>
        <span class="key">password</span>: <span class="string"><span class="content">secret</span></span>
        <span class="key">url</span>: <span class="string"><span class="content">jdbc:mysql://localhost/lookup</span></span>
        <span class="key">dbCreate</span>: <span class="string"><span class="content">update</span></span>

<span class="key">environments</span>:
    <span class="key">development</span>:
        <span class="key">dataSource</span>:
            <span class="key">dbCreate</span>: <span class="string"><span class="content">create-drop</span></span>
            <span class="key">url</span>: <span class="string"><span class="content">jdbc:h2:mem:devDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE</span></span>
    <span class="key">test</span>:
        <span class="key">dataSource</span>:
            <span class="key">dbCreate</span>: <span class="string"><span class="content">update</span></span>
            <span class="key">url</span>: <span class="string"><span class="content">jdbc:h2:mem:testDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE</span></span>
    <span class="key">production</span>:
        <span class="key">dataSource</span>:
            <span class="key">dbCreate</span>: <span class="string"><span class="content">update</span></span>
            <span class="key">url</span>: <span class="string"><span class="content">jdbc:h2:prodDb;MVCC=TRUE;LOCK_TIMEOUT=10000;DB_CLOSE_ON_EXIT=FALSE</span></span>
            <span class="key">properties</span>:
                <span class="key">jmxEnabled</span>: <span class="string"><span class="content">true</span></span>
                <span class="key">initialSize</span>: <span class="string"><span class="content">5</span></span>
                <span class="error">...</span>
        <span class="key">dataSources</span>:
            <span class="key">lookup</span>:
                <span class="key">dialect</span>: <span class="string"><span class="content">org.hibernate.dialect.Oracle10gDialect</span></span>
                <span class="key">driverClassName</span>: <span class="string"><span class="content">oracle.jdbc.driver.OracleDriver</span></span>
                <span class="key">username</span>: <span class="string"><span class="content">lookup</span></span>
                <span class="key">password</span>: <span class="string"><span class="content">secret</span></span>
                <span class="key">url</span>: <span class="string"><span class="content">jdbc:oracle:thin:@localhost:1521:lookup</span></span>
                <span class="key">dbCreate</span>: <span class="string"><span class="content">update</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以使用相同或不同的数据库，只要 Hibernate 支持即可。</p>
</div>
<div class="paragraph">
<p>如果您需要在 Grails 工件中注入 <code>lookup</code> 数据源，则可以这样进行：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">DataSource</span> dataSource_lookup</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
在定义多个数据源时，<strong>必须</strong> 有一个被命名为 "dataSource"。这是必需的，因为 Grails 通过确定哪个数据源被命名为 "dataSource" 来确定哪个数据源是默认的。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_配置_domain_类">配置 Domain 类</h4>
<div class="paragraph">
<p>如果域类没有 <code>DataSource</code> 配置，则默认为标准的 <code>'dataSource'</code> 。在 <code>mapping</code> 块中设置 <code>datasource</code> 属性，以配置非默认的 <code>DataSource</code> 。例如，如果您想使用 <code>ZipCode</code> 域来使用 <code>'lookup'</code> <code>DataSource</code> ，请按以下方式进行配置：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ZipCode</span> {

   <span class="predefined-type">String</span> code

   <span class="directive">static</span> mapping = {
      datasource <span class="string"><span class="delimiter">'</span><span class="content">lookup</span><span class="delimiter">'</span></span>
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>域类也可以使用两个或多个数据源。将 <code>datasources</code> 属性与名称列表一起使用可以配置多个名称，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ZipCode</span> {

   <span class="predefined-type">String</span> code

   <span class="directive">static</span> mapping = {
      datasources([<span class="string"><span class="delimiter">'</span><span class="content">lookup</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">auditing</span><span class="delimiter">'</span></span>])
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果域类使用默认的 <code>DataSource</code> 和一个或多个其他类，请使用特殊名称 <code>DEFAULT</code> 来指示默认的 <code>DataSource</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ZipCode</span> {

   <span class="predefined-type">String</span> code

   <span class="directive">static</span> mapping = {
      datasources([<span class="string"><span class="delimiter">'</span><span class="content">lookup</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">DEFAULT</span><span class="delimiter">'</span></span>])
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果域类使用所有已配置的数据源，请使用特殊值 <code>'ALL'</code>：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ZipCode</span> {

   <span class="predefined-type">String</span> code

   <span class="directive">static</span> mapping = {
      datasource <span class="string"><span class="delimiter">'</span><span class="content">ALL</span><span class="delimiter">'</span></span>
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_命名空间和_gorm_方法">命名空间和 GORM 方法</h4>
<div class="paragraph">
<p>如果域类使用多个 <code>DataSource</code> ，则可以使用每个 <code>DataSource</code> 名称隐含的命名空间对特定的 <code>DataSource</code> 进行GORM调用。例如，考虑使用两个数据源的此类：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">ZipCode</span> {

   <span class="predefined-type">String</span> code

   <span class="directive">static</span> mapping = {
      datasources([<span class="string"><span class="delimiter">'</span><span class="content">lookup</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">auditing</span><span class="delimiter">'</span></span>])
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>当不使用显式命名空间时，指定的第一个 <code>DataSource</code> 是默认值，因此在这种情况下，我们默认为 <code>'lookup'</code> 。但是您可以使用 <code>DataSource</code> 名称在 'auditing' <code>DataSource</code> 上调用 GORM 方法，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> zipCode = ZipCode.auditing.get(<span class="integer">42</span>)
...
zipCode.auditing.save()</code></pre>
</div>
</div>
<div class="paragraph">
<p>如您所见，在静态情况和实例情况下，都将 <code>DataSource</code> 添加到方法调用中。</p>
</div>
</div>
<div class="sect3">
<h4 id="_hibernate_映射_domain_类">Hibernate 映射 Domain 类</h4>
<div class="paragraph">
<p>您还可以将带注释的 Java 类划分为单独的数据源。使用默认数据源的类在 <code>grails-app/conf/hibernate.cfg.xml</code> 中注册。要指定带注释的类使用非默认数据源，请为该数据源创建一个 <code>hibernate.cfg.xml</code> 文件，文件名以该数据源名称为前缀。</p>
</div>
<div class="paragraph">
<p>例如，如果 <code>Book</code> 类位于默认数据源中，则可以在 <code>grails-app/conf/hibernate.cfg.xml</code> 中进行注册：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span>
<span class="doctype">&lt;!DOCTYPE hibernate-configuration PUBLIC
          '-//Hibernate/Hibernate Configuration DTD 3.0//EN'
          'http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd'&gt;</span>
<span class="tag">&lt;hibernate-configuration&gt;</span>
   <span class="tag">&lt;session-factory&gt;</span>
      <span class="tag">&lt;mapping</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">'</span><span class="content">org.example.Book</span><span class="delimiter">'</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;/session-factory&gt;</span>
<span class="tag">&lt;/hibernate-configuration&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果 <code>Library</code> 类位于 "ds2" 数据源中，则可以在 <code>grails-app/conf/ds2_hibernate.cfg.xml</code> 中进行注册：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span>
<span class="doctype">&lt;!DOCTYPE hibernate-configuration PUBLIC
          '-//Hibernate/Hibernate Configuration DTD 3.0//EN'
          'http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd'&gt;</span>
<span class="tag">&lt;hibernate-configuration&gt;</span>
   <span class="tag">&lt;session-factory&gt;</span>
      <span class="tag">&lt;mapping</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">'</span><span class="content">org.example.Library</span><span class="delimiter">'</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;/session-factory&gt;</span>
<span class="tag">&lt;/hibernate-configuration&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>对于使用 hbm.xml 文件映射的类，该过程相同-只需在相应的 hibernate.cfg.xml 文件中列出它们即可。</p>
</div>
</div>
<div class="sect3">
<h4 id="_services">Services</h4>
<div class="paragraph">
<p>与 Domain 类一样，默认情况下，Services 使用默认的 <code>DataSource</code> 和 <code>PlatformTransactionManager</code> 。要将服务配置为使用其他 <code>DataSource</code> ，请使用静态 <code>datasource</code> 属性，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">DataService</span> {

   <span class="directive">static</span> datasource = <span class="string"><span class="delimiter">'</span><span class="content">lookup</span><span class="delimiter">'</span></span>

   <span class="type">void</span> someMethod(...) {
      ...
   }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>事务性服务只能使用单个 <code>DataSource</code> ，因此请确保仅对 <code>DataSource</code> 与 "Service" 相同的域类进行更改。</p>
</div>
<div class="paragraph">
<p>请注意，服务中指定的数据源与用于域类的数据源无关。这取决于它们在域类本身中声明的数据源。用于声明要使用的事务管理器。</p>
</div>
<div class="paragraph">
<p>如果您在 <code>dataSource1</code> 中有一个 <code>Foo</code> 域类，而在 <code>dataSource2</code> 中有一个 <code>Bar</code> 域类，如果 <code>WahooService</code> 使用 <code>dataSource1</code> ，这是一种保存新 <code>Foo</code> 和新 <code>Bar</code> 的服务方法。由于它们共享相同的数据源，因此只会对 <code>Foo</code> 进行交易。交易不会影响 <code>Bar</code> 实例。如果您希望两者都是事务性的，则需要使用两个服务和XA数据源进行两阶段提交，例如使用 Atomikos 插件。</p>
</div>
</div>
<div class="sect3">
<h4 id="_跨多个数据源的事务">跨多个数据源的事务</h4>
<div class="paragraph">
<p>默认情况下，Grails 不会尝试处理跨越多个数据源的事务。</p>
</div>
<div class="paragraph">
<p>您可以启用 Grails 使用 "尽力而为1PC模式（Best Effort 1PC）" 处理跨多个数据源的事务。为此，您必须在 <code>application.yml</code> 中将 <code>grails.transaction.chainedTransactionManagerPostProcessor.enabled</code> 设置设置为 <code>true</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
  <span class="key">transaction</span>:
    <span class="key">chainedTransactionManagerPostProcessor</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://www.javaworld.com/article/2077963/open-source-tools/distributed-transactions-in-spring-with-and-without-xa.html">尽力而为1PC模式</a> 相当普遍，但可能会失败在某些情况下，开发人员必须了解。</p>
</div>
<div class="paragraph">
<p>这是一种非 XA 模式，涉及多个资源的同步单阶段提交。因为没有使用 <a href="#ref-orgwiki-twophasecommit-2PC">2PC</a>，所以它永远不能像 <a href="#ref-orgwiki-x-open-xa-XA">XA</a> 事务一样安全，但是通常是好的如果参与者知道这些折衷，就足够了。</p>
</div>
<div class="paragraph">
<p>基本思想是在事务中尽可能延迟所有资源的提交，以便唯一可能出错的是基础结构故障（而不是业务处理错误）。依靠 BE1PC 的系统认为，基础结构故障非常罕见，以至于他们可以承担风险以换取更高的吞吐量。如果业务处理服务也被设计为幂等的，那么实践中几乎不会出错。</p>
</div>
<div class="paragraph">
<p>BE1PC 实现已在 Grails 2.3.6 中添加 。在此更改之前，其他数据源未参与 Grails 中启动的事务。其他数据源中的事务基本上处于自动提交模式。在某些情况下，这可能是所需的行为。原因可能是性能：在每个新事务开始时，BE1PC 事务管理器都会为每个数据源创建一个新事务。通过在附加数据源的相应配置块中设置 <code>transactional = false</code> ，可以将附加数据源留在 BE1PC 事务管理器之外。<code>readOnly = true</code> 的数据源也将从链式事务管理器中删除（自2.3.7开始）。</p>
</div>
<div class="paragraph">
<p>默认情况下，BE1PC 实现会将所有实现 Spring <a href="https://docs.spring.io/spring/docs/current/javadoc-api//org/springframework/transaction/PlatformTransactionManager.html">PlatformTransactionManager</a> 接口的 bean 添加到链接的 BE1PC 事务管理器中。例如，可能会将 Grails 应用程序上下文中的一个可能的 <a href="https://docs.spring.io/spring/docs/current/javadoc-api//org/springframework/jms/connection/JmsTransactionManager.html">JMSTransactionManager</a> bean 添加到 Grails BE1PC 事务管理器的事务管理器链中。</p>
</div>
<div class="paragraph">
<p>您可以使用以下配置选项从BE1PC实现中排除事务管理器bean：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
  <span class="key">transaction</span>:
    <span class="key">chainedTransactionManagerPostProcessor</span>:
      <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span>
      <span class="key">blacklistPattern</span>: <span class="string"><span class="content">'.*'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>排除匹配是在事务管理器 bean 的名称上完成的。带有 <code>transactional = false</code> 或 <code>readOnly = true</code> 的数据源的事务管理器将被跳过，在这种情况下不需要使用此配置选项。</p>
</div>
</div>
<div class="sect3">
<h4 id="_xa和两阶段提交">XA和两阶段提交</h4>
<div class="paragraph">
<p>当"尽力而为"1PC模式不适合跨多个事务资源（不仅是数据源）处理事务时，可以使用多种选项将 XA/2PC 支持添加到 Grails应用程序。</p>
</div>
<div class="paragraph">
<p><a href="{springdocs}/transaction.html#transaction-application-server-integration">Spring交易文档</a> 包含有关集成不同应用程序服务器的 JTA/XA 交易管理器的信息。在这种情况下，您可以在 <code>resources.groovy</code> 或 <code>resources.xml</code> 文件中手动配置名为 <code>transactionManager</code> 的 bean。</p>
</div>
</div>

<a name="3.5 &#29256;&#26412;"><!-- Legacy link --></a>
<h2 id="versioning">4.5 版本控制</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/versioning.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="sect3">
<h4 id="_运行时检测版本">运行时检测版本</h4>
<div class="paragraph">
<p>您可以使用 <a href="http://docs.grails.org/4.0.0/api/grails/core/GrailsApplication.html">GrailsApplication</a> 类使用 Grails 对应用程序元数据的支持来检测应用程序版本。例如，在 <a href="theWebLayer.html＃controllers">controllers</a> 中，有一个隐式链接 <a href="../ref/Controllers/grailsApplication.html">grailsApplication</a> 变量可以使用：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> version = grailsApplication.metadata.getApplicationVersion()</code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以获取运行的 Grails 版本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> grailsVersion = grailsApplication.metadata.getGrailsVersion()</code></pre>
</div>
</div>
<div class="paragraph">
<p>或通过 <code>GrailsUtil</code> 类：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.util.GrailsUtil</span>
...
def grailsVersion = GrailsUtil.grailsVersion</code></pre>
</div>
</div>
</div>

<a name="3.7 &#20381;&#36182;&#35299;&#26512;"><!-- Legacy link --></a>
<h2 id="dependencyResolution">4.6 依赖项解析</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/conf/dependencyResolution.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>依赖关系解析是由 <a href="http://gradle.org">Gradle build tool</a> 处理的，所有依赖关系都在 <code>build.gradle</code> 文件中定义。 有关更多信息，请参考 <a href="commandLine.html＃gradleBuild">Gradle 用户指南</a> 。</p>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/upgrading.html">&lt;&lt; <strong>3</strong><span>&#20174; Grails 3.3.x &#21319;&#32423;</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/commandLine.html"><strong>5</strong><span>&#21629;&#20196;&#34892;</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Command%20Line/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/bug-report.html">bug-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/clean.html">clean</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/compile.html">compile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/console.html">console</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-app.html">create-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-command.html">create-command</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-controller.html">create-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-domain-class.html">create-domain-class</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-functional-test.html">create-functional-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-hibernate-cfg-xml.html">create-hibernate-cfg-xml</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-integration-test.html">create-integration-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-interceptor.html">create-interceptor</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-plugin.html">create-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-profile.html">create-profile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-script.html">create-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-service.html">create-service</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-taglib.html">create-taglib</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-unit-test.html">create-unit-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/dependency-report.html">dependency-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/docs.html">docs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-all.html">generate-all</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-controller.html">generate-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-views.html">generate-views</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/help.html">help</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/install-templates.html">install-templates</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/list-plugins.html">list-plugins</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/list-profiles.html">list-profiles</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/package-plugin.html">package-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/package.html">package</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/plugin-info.html">plugin-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/profile-info.html">profile-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-app.html">run-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-command.html">run-command</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-script.html">run-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/schema-export.html">schema-export</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/shell.html">shell</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/stats.html">stats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/stop-app.html">stop-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/test-app.html">test-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/war.html">war</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Constraints</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Constraints/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Constraints/attributes.html">attributes</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/bindable.html">bindable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/blank.html">blank</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/creditCard.html">creditCard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/email.html">email</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/inList.html">inList</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/matches.html">matches</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/max.html">max</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/maxSize.html">maxSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/min.html">min</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/minSize.html">minSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/notEqual.html">notEqual</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/nullable.html">nullable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/range.html">range</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/scale.html">scale</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/size.html">size</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/unique.html">unique</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/url.html">url</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/validator.html">validator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/widget.html">widget</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Controllers</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Controllers/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Controllers/actionName.html">actionName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/allowedMethods.html">allowedMethods</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/bindData.html">bindData</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/chain.html">chain</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/controllerName.html">controllerName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/defaultAction.html">defaultAction</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/flash.html">flash</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/forward.html">forward</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/grailsApplication.html">grailsApplication</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/namespace.html">namespace</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/params.html">params</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/redirect.html">redirect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/respond.html">respond</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/responseFormats.html">responseFormats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/session.html">session</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/withForm.html">withForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/withFormat.html">withFormat</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Database Mapping</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Database%20Mapping/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/autoImport.html">autoImport</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/autoTimestamp.html">autoTimestamp</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/batchSize.html">batchSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/cache.html">cache</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/cascade.html">cascade</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/column.html">column</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/comment.html">comment</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/discriminator.html">discriminator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/dynamicInsert.html">dynamicInsert</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/dynamicUpdate.html">dynamicUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/fetch.html">fetch</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/id.html">id</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/ignoreNotFound.html">ignoreNotFound</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/indexColumn.html">indexColumn</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/insertable.html">insertable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/joinTable.html">joinTable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/lazy.html">lazy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/order.html">order</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/sort.html">sort</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/table.html">table</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/type.html">type</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/updateable.html">updateable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/version.html">version</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Domain Classes</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Domain%20Classes/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/addTo.html">addTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/attach.html">attach</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/belongsTo.html">belongsTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/clearErrors.html">clearErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/constraints.html">constraints</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/count.html">count</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/countBy.html">countBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/createCriteria.html">createCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/delete.html">delete</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/discard.html">discard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/embedded.html">embedded</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/executeQuery.html">executeQuery</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/executeUpdate.html">executeUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/exists.html">exists</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/fetchMode.html">fetchMode</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/find.html">find</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAll.html">findAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAllBy.html">findAllBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAllWhere.html">findAllWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findBy.html">findBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrCreateBy.html">findOrCreateBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrCreateWhere.html">findOrCreateWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrSaveBy.html">findOrSaveBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrSaveWhere.html">findOrSaveWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findWhere.html">findWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/first.html">first</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/get.html">get</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getAll.html">getAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getDirtyPropertyNames.html">getDirtyPropertyNames</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getPersistentValue.html">getPersistentValue</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasMany.html">hasMany</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasOne.html">hasOne</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/ident.html">ident</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/instanceOf.html">instanceOf</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/isAttached.html">isAttached</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/isDirty.html">isDirty</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/last.html">last</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/list.html">list</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/listOrderBy.html">listOrderBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/load.html">load</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/lock.html">lock</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mapWith.html">mapWith</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mappedBy.html">mappedBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mapping.html">mapping</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/merge.html">merge</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/namedQueries.html">namedQueries</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/properties.html">properties</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/read.html">read</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/refresh.html">refresh</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/removeFrom.html">removeFrom</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/save.html">save</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/transients.html">transients</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/validate.html">validate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/where.html">where</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/whereAny.html">whereAny</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withCriteria.html">withCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withNewSession.html">withNewSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withSession.html">withSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withTransaction.html">withTransaction</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Plug-ins</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Plug-ins/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/URL%20mappings.html">URL mappings</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/codecs.html">codecs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/controllers.html">controllers</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/core.html">core</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/dataSource.html">dataSource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/domainClasses.html">domainClasses</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/hibernate.html">hibernate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/i18n.html">i18n</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/logging.html">logging</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/scaffolding.html">scaffolding</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/services.html">services</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/servlets.html">servlets</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Services</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Services/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Services/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Services/transactional.html">transactional</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Servlet API</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/session.html">session</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
