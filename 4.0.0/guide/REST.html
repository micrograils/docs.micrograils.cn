<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script src="/cdn-cgi/apps/head/3cOPSgo5Omz84ycX7CvigfX4cpw.js"></script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-82213539-2"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-82213539-2');
    </script>
    <title>10 REST 4.0.0</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8"/>
    <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8"/>
    <script type="text/javascript">
function addJsClass() {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
</head>

<body class="body" onload="addJsClass();">
<div id="navigation">
    <div class="navTitle">
        
        The Grails Framework
    </div>
    <div class="navLinks">
        <ul>
            <li>
                <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                    <a href="../guide/index.html" class="button">Table of contents</a>

                    <div id="nav-summary-childs" style="display:none;">
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/introduction.html"><strong>1</strong><span>&#31616;&#20171;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/gettingStarted.html"><strong>2</strong><span>&#20837;&#38376;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/upgrading.html"><strong>3</strong><span>&#20174; Grails 3.3.x &#21319;&#32423;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/conf.html"><strong>4</strong><span>&#37197;&#32622;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/commandLine.html"><strong>5</strong><span>&#21629;&#20196;&#34892;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/profiles.html"><strong>6</strong><span>&#24212;&#29992;&#31243;&#24207;&#37197;&#32622;&#25991;&#20214;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/GORM.html"><strong>7</strong><span>&#23545;&#35937;&#20851;&#31995;&#26144;&#23556; &#65288;GORM&#65289;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/theWebLayer.html"><strong>8</strong><span>Web &#23618;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/traits.html"><strong>9</strong><span>&#29305;&#24449;&#65288;Trait&#65289;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/REST.html"><strong>10</strong><span>REST</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/async.html"><strong>11</strong><span>&#24322;&#27493;&#32534;&#31243;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/validation.html"><strong>12</strong><span>&#39564;&#35777;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/services.html"><strong>13</strong><span>&#26381;&#21153;&#23618;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/staticTypeCheckingAndCompilation.html"><strong>14</strong><span>&#38745;&#24577;&#31867;&#22411;&#26816;&#26597;&#21644;&#32534;&#35793;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/testing.html"><strong>15</strong><span>&#27979;&#35797;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/i18n.html"><strong>16</strong><span>&#22269;&#38469;&#21270;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/security.html"><strong>17</strong><span>&#23433;&#20840;&#24615;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/plugins.html"><strong>18</strong><span>&#25554;&#20214;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/spring.html"><strong>19</strong><span>Grails &#19982; Spring</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/scaffolding.html"><strong>20</strong><span>&#33050;&#25163;&#26550;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/deployment.html"><strong>21</strong><span>&#37096;&#32626;</span></a>
                        </div>
                        
                        <div class="toc-item" style="margin-left:0"><a href="../guide/contributing.html"><strong>22</strong><span>&#32473; Grails &#36129;&#29486;&#20195;&#30721;</span></a>
                        </div>
                        
                    </div>
                </div>
            </li>
            <li class="separator selected">
                <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
            </li>
        </ul>
    </div>


</div>

<table id="colset" border="0" cellpadding="0" cellspacing="0">
    <tr>
        <td id="col1">
            <div id="main" class="corner-all">

                
                    <div class="toc-item prev-left"><a href="../guide/traits.html">&lt;&lt; <strong>9</strong><span>&#29305;&#24449;&#65288;Trait&#65289;</span></a></div>
                

                <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                
                    <div class="toc-item next-right"><a href="../guide/async.html"><strong>11</strong><span>&#24322;&#27493;&#32534;&#31243;</span> >></a></div>
                


                <div class="project">
                    <h1>10 REST</h1>

                    <p><strong>Version:</strong> 4.0.0</p>
                </div>

                
                <div id="table-of-content">
                    <h2>Table of Contents</h2>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#domainResources"><strong>10.1</strong><span>&#22495;&#31867;&#20316;&#20026; REST &#36164;&#28304;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#urlMappings"><strong>10.2</strong><span>&#26144;&#23556;&#21040; REST &#36164;&#28304;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#linkingToResources"><strong>10.3</strong><span>&#20174; GSP &#39029;&#38754;&#38142;&#25509;&#21040; REST &#36164;&#28304;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#versioningResources"><strong>10.4</strong><span>&#29256;&#26412;&#21270; REST &#36164;&#28304;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#restfulControllers"><strong>10.5</strong><span>&#23454;&#29616; REST &#25511;&#21046;&#22120;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#extendingRestfulController"><strong>10.5.1</strong><span>&#25193;&#23637;Rest&#25511;&#21046;&#22120;&#36229;&#32423;&#31867;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#restControllersStepByStep"><strong>10.5.2</strong><span>&#36880;&#27493;&#23454;&#29616; REST &#25511;&#21046;&#22120;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#generatingRestControllers"><strong>10.5.3</strong><span>&#20351;&#29992;&#22522;&#26550;&#29983;&#25104; REST &#25511;&#21046;&#22120;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#callingRestServices"><strong>10.6</strong><span>&#20351;&#29992; HttpClient &#35843;&#29992; REST &#26381;&#21153;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#restProfile"><strong>10.7</strong><span>REST &#37197;&#32622;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#angularJsProfile"><strong>10.8</strong><span>AngularJS &#37197;&#32622;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#angularProfile"><strong>10.9</strong><span>Angular &#37197;&#32622;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#jsonViews"><strong>10.10</strong><span>JSON &#35270;&#22270;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#jsonViewsSetup"><strong>10.10.1</strong><span>&#20837;&#38376;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#jsonViewsCreating"><strong>10.10.2</strong><span>&#21019;&#24314; JSON &#35270;&#22270;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#jsonViewsAndTemplates"><strong>10.10.3</strong><span>JSON &#35270;&#22270;&#27169;&#26495;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#jsonViewsAndDomainClasses"><strong>10.10.4</strong><span>&#20351;&#29992; JSON &#35270;&#22270;&#21576;&#29616;&#22495;&#31867;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#jsonViewsTemplatesAndConventions"><strong>10.10.5</strong><span>&#25353;&#32422;&#23450;&#36827;&#34892;&#30340; JSON &#35270;&#22270;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#renderers"><strong>10.11</strong><span>&#33258;&#23450;&#20041;&#21709;&#24212;&#21576;&#29616;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#defaultRenderers"><strong>10.11.1</strong><span>&#33258;&#23450;&#20041;&#40664;&#35748;&#28210;&#26579;&#22120;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#customRenderers"><strong>10.11.2</strong><span>&#23454;&#29616;&#33258;&#23450;&#20041;&#28210;&#26579;&#22120;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#gspRenderers"><strong>10.11.3</strong><span>&#20351;&#29992; GSP &#33258;&#23450;&#20041;&#28210;&#26579;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#hypermedia"><strong>10.12</strong><span>&#36229;&#23186;&#20307;&#20316;&#20026;&#24212;&#29992;&#31243;&#24207;&#29366;&#24577;&#30340;&#24341;&#25806;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#hal"><strong>10.12.1</strong><span>HAL &#25903;&#25345;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#atom"><strong>10.12.2</strong><span>Atom &#25903;&#25345;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:10px"><a href="#vndError"><strong>10.12.3</strong><span>Vnd.&#38169;&#35823;&#25903;&#25345;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#binding"><strong>10.13</strong><span>&#33258;&#23450;&#20041;&#36164;&#28304;&#32465;&#23450;</span></a>
                    </div>
                    
                    <div class="toc-item" style="margin-left:0px"><a href="#RSSAndAtom"><strong>10.14</strong><span>RSS &#21644; Atom</span></a>
                    </div>
                    
                </div>
                

                
<a name="8.1 REST"><!-- Legacy link --></a>
<h1 id="REST">10 REST</h1>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>REST本身并不是一种真正的技术，而是一种架构模式。 REST非常简单，仅涉及使用纯XML或JSON作为通信介质，并结合了作为基础系统“代表”的URL模式以及HTTP方法（例如GET，PUT，POST和DELETE）。
每个HTTP方法都映射到一个类型。 例如，GET用于检索数据，POST用于创建数据，PUT用于更新等等。
Grails包含灵活的功能，可轻松创建RESTful API。 创建RESTful资源只需一行代码即可，如下一节所述。</p>
</div>


<h2 id="domainResources">10.1 域类作为 REST 资源</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/domainResources.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>在Grails中创建RESTful API的最简单方法是将域类公开为REST资源。这可以通过在任何域类中添加 <code>grails.rest.Resource</code> 转换来完成：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.*</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/books</span><span class="delimiter">'</span></span>)
<span class="type">class</span> <span class="class">Book</span> {

    <span class="predefined-type">String</span> title

    <span class="directive">static</span> constraints = {
        title <span class="key">blank</span>:<span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>简单地通过添加 <code>Resource</code> 转换并指定URI，您的域类将自动以XML或JSON格式用作REST资源。转换将自动注册必要的<a href="theWebLayer.html＃restfulMappings">RESTful URL mapping</a>并创建一个名为 <code>BookController</code> 的控制器。</p>
</div>
<div class="paragraph">
<p>您可以通过向BootStrap.groovy添加一些测试数据来进行尝试：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> init = { servletContext -&gt;
    <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>).save()
    <span class="keyword">new</span> <span class="predefined-type">Book</span>(<span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Shining</span><span class="delimiter">&quot;</span></span>).save()
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后点击URL <a href="http://localhost8080/books/1" class="bare">http://localhost8080/books/1</a>, 它将显示如下响应：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="tag">&lt;book</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;title&gt;</span>The Stand<span class="tag">&lt;/title&gt;</span>
<span class="tag">&lt;/book&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>如果将URL更改为 <a href="http://localhost:8080/books/1.json" class="bare">http://localhost:8080/books/1.json</a>, 您将获得JSON响应，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">id</span><span class="delimiter">&quot;</span></span>:<span class="integer">1</span>,<span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您希望更改默认值以返回JSON而不是XML，则可以通过设置 <code>Resource</code> 转换的 <code>formats</code> 属性来实现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.*</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/books</span><span class="delimiter">'</span></span>, formats=[<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>])
<span class="type">class</span> <span class="class">Book</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>在上面的示例中，JSON将具有优先级。传递的列表应包含资源应公开的格式的名称。格式的名称在application.groovy的grails.mime.types设置中定义：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.mime.types = [
    ...
    json:          [<span class="string"><span class="delimiter">'</span><span class="content">application/json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">text/json</span><span class="delimiter">'</span></span>],
    ...
    xml:           [<span class="string"><span class="delimiter">'</span><span class="content">text/xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">application/xml</span><span class="delimiter">'</span></span>]
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>有关更多信息，请参见用户指南中的<a href="theWebLayer.html＃contentNegotiation">配置Mime类型</a>部分。</p>
</div>
<div class="paragraph">
<p>除了使用URI中的文件扩展名，您还可以使用ACCEPT标头获得JSON响应。这是使用Unix <code>curl</code> 工具的示例：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Accept: application/json&quot; localhost:8080/books/1
{&quot;id&quot;:1,&quot;title&quot;:&quot;The Stand&quot;}</code></pre>
</div>
</div>
<div class="paragraph">
<p>这要归功于Grails的<a href="theWebLayer.html＃contentNegotiation">Content Negotiation</a>功能。</p>
</div>
<div class="paragraph">
<p>您可以通过发出POST请求来创建新资源：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -X POST -H &quot;Content-Type: application/json&quot; -d '{&quot;title&quot;:&quot;Along Came A Spider&quot;}' localhost:8080/books
HTTP/1.1 201 Created
Server: Apache-Coyote/1.1
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>更新可以通过 <code>PUT</code> 请求来完成：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -X PUT -H &quot;Content-Type: application/json&quot; -d '{&quot;title&quot;:&quot;Along Came A Spider&quot;}' localhost:8080/books/1
HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>最后，可以通过 <code>DELETE</code> 请求删除资源：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -X DELETE localhost:8080/books/1
HTTP/1.1 204 No Content
Server: Apache-Coyote/1.1
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>如您所见，<code>Resource</code> 转换启用了资源上的所有HTTP方法动词。您可以通过将 <code>readOnly</code> 属性设置为true来仅启用只读功能：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.*</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/books</span><span class="delimiter">'</span></span>, readOnly=<span class="predefined-constant">true</span>)
<span class="type">class</span> <span class="class">Book</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>在这种情况下，<code>POST</code>，<code>PUT</code> 和 <code>DELETE</code> 请求将被禁止。</p>
</div>


<h2 id="urlMappings">10.2 映射到 REST 资源</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/urlMappings.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如果您希望将URL映射的声明保留在 <code>UrlMappings.groovy</code> 文件中，则只需删除 <code>Resource</code> 转换的 <code>uri</code> 属性，并将以下行添加到 <code>UrlMappings.groovy</code> 中就足够了：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">&quot;</span><span class="content">/books</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>扩展您的API以包括更多端点将变得微不足道：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">&quot;</span><span class="content">/books</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>) {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">/publisher</span><span class="delimiter">&quot;</span></span>(<span class="key">controller</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">publisher</span><span class="delimiter">&quot;</span></span>, <span class="key">method</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>上面的示例将公开URI <code>/books/1/publisher</code>。</p>
</div>
<div class="paragraph">
<p>更详细的解释 <a href="theWebLayer.html#restfulMappings">creating RESTful URL mappings</a> 可以在 <a href="theWebLayer.html#urlmappings">URL Mappings section</a> 用户指南。</p>
</div>


<h2 id="linkingToResources">10.3 从 GSP 页面链接到 REST 资源</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/linkingToResources.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>链接标签提供了一种链接到任何域类资源的简便方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;g:link</span> <span class="attribute-name">resource</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${book}</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>My Link<span class="tag">&lt;/g:link&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>但是，当前您不能使用g:link链接到DELETE操作，并且大多数浏览器不支持直接发送DELETE方法。</p>
</div>
<div class="paragraph">
<p>最好的方法是使用表单提交：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;form</span> <span class="attribute-name">action</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">/book/2</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">method</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">post</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
         <span class="tag">&lt;input</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">hidden</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">_method</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">DELETE</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/form&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Grails支持通过隐藏的_method参数覆盖请求方法。这是出于浏览器兼容性的目的。当使用静态资源映射创建功能强大的Web界面时，这很有用。
为了使链接触发此类事件，也许捕获具有data-method属性的链接的所有click事件，然后通过JavaScript提交表单提交。</p>
</div>


<h2 id="versioningResources">10.4 版本化 REST 资源</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/versioningResources.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>REST API的一个常见要求是同时公开不同的版本。 Grails中有几种​​方法可以实现。</p>
</div>
<div class="sect3">
<h4 id="_使用uri进行版本控制">使用URI进行版本控制</h4>
<div class="paragraph">
<p>一种常见的方法是使用URI来对API进行版本控制（尽管不建议使用此方法，而建议使用Hypermedia）。例如，您可以定义以下URL映射：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">&quot;</span><span class="content">/books/v1</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v1</span><span class="delimiter">'</span></span>)
<span class="string"><span class="delimiter">&quot;</span><span class="content">/books/v2</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v2</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将与以下控制器匹配：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> myapp.v1

<span class="type">class</span> <span class="class">BookController</span> {
    <span class="directive">static</span> namespace = <span class="string"><span class="delimiter">'</span><span class="content">v1</span><span class="delimiter">'</span></span>
}

<span class="keyword">package</span> myapp.v2

<span class="type">class</span> <span class="class">BookController</span> {
    <span class="directive">static</span> namespace = <span class="string"><span class="delimiter">'</span><span class="content">v2</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>这种方法的缺点是您的API需要两个不同的URI名称空间。</p>
</div>
</div>
<div class="sect3">
<h4 id="_使用accept_version标头进行版本控制">使用Accept-Version标头进行版本控制</h4>
<div class="paragraph">
<p>作为替代方案，Grails支持从客户端传递 <code>Accept-Version</code> 标头。例如，您可以定义以下URL映射：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">&quot;</span><span class="content">/books</span><span class="delimiter">&quot;</span></span>(<span class="key">version</span>:<span class="string"><span class="delimiter">'</span><span class="content">1.0</span><span class="delimiter">'</span></span>, <span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v1</span><span class="delimiter">'</span></span>)
<span class="string"><span class="delimiter">&quot;</span><span class="content">/books</span><span class="delimiter">&quot;</span></span>(<span class="key">version</span>:<span class="string"><span class="delimiter">'</span><span class="content">2.0</span><span class="delimiter">'</span></span>, <span class="key">resources</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>, <span class="key">namespace</span>:<span class="string"><span class="delimiter">'</span><span class="content">v2</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后在客户端使用 <code>Accept-Version</code> 标头简单地传递您需要的版本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Accept-Version: 1.0&quot; -X GET http://localhost:8080/books</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_使用hypermedia_mime类型进行版本控制">使用Hypermedia / Mime类型进行版本控制</h4>
<div class="paragraph">
<p>版本控制的另一种方法是使用Mime Type定义来声明自定义媒体类型的版本（有关Hypermedia概念的更多信息，请参见 <code>作为应用程序状态引擎的超媒体</code> 一节）。例如，在 <code>application.groovy</code> 中，您可以为您的资源声明一个自定义的Mime类型，其中包括版本参数（ <code>v</code> 参数）：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.mime.types = [
    <span class="key">all</span>: <span class="string"><span class="delimiter">'</span><span class="content">*/*</span><span class="delimiter">'</span></span>,
    <span class="key">book</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json;v=1.0</span><span class="delimiter">&quot;</span></span>,
    <span class="key">bookv2</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json;v=2.0</span><span class="delimiter">&quot;</span></span>,
    ...
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
将新的MIME类型放在 <code>所有</code> MIME类型之后非常重要，因为如果无法建立请求的内容类型，则映射中的第一个条目将用作响应。如果您的新Mime类型位于顶部，那么在无法建立请求的Mime类型时，Grails将始终尝试发送新的Mime类型。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>然后覆盖渲染器（有关自定义渲染器的更多信息，请参见 <code>自定义响应渲染</code> 部分），以在grails-app/conf/spring/resourses.groovy中发送自定义Mime类型：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.json.*</span>
<span class="keyword">import</span> <span class="include">grails.web.mime.*</span>

beans = {
    bookRendererV1(JsonRenderer, myapp.v1.Book, <span class="keyword">new</span> MimeType(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json</span><span class="delimiter">&quot;</span></span>, [<span class="key">v</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>]))
    bookRendererV2(JsonRenderer, myapp.v2.Book, <span class="keyword">new</span> MimeType(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json</span><span class="delimiter">&quot;</span></span>, [<span class="key">v</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">2.0</span><span class="delimiter">&quot;</span></span>]))
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后更新控制器中可接受的响应格式列表：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> <span class="directive">extends</span> RestfulController {
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">book</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">bookv2</span><span class="delimiter">'</span></span>]

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后使用 <code>Accept</code> 标头可以使用Mime Type指定所需的版本：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> curl -i -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Accept: application/vnd.books.org.book+json;v=1.0</span><span class="delimiter">&quot;</span></span> -X GET <span class="key">http</span>:<span class="comment">//localhost:8080/books</span></code></pre>
</div>
</div>
</div>


<h2 id="restfulControllers">10.5 实现 REST 控制器</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/restfulControllers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><code>资源</code> 转换是一种快速的入门方法，但是通常您需要自定义控制器逻辑，响应的呈现或扩展API以包括其他操作。</p>
</div>


<h2 id="extendingRestfulController">10.5.1 扩展Rest控制器超级类</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/restfulControllers/extendingRestfulController.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>开始这样做的最简单方法是为您的资源创建一个扩展 <code>grails.rest.RestfulController</code> 超级类的新控制器。例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> <span class="directive">extends</span> RestfulController&lt;<span class="predefined-type">Book</span>&gt; {
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>]
    BookController() {
        <span class="local-variable">super</span>(<span class="predefined-type">Book</span>)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>要自定义任何逻辑，只需重写相应的操作。下表提供了操作名的名称及其映射到的uri：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">URI</th>
<th class="tableblock halign-left valign-top">Controller Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">save</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}/edit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">edit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
只有当控制器公开HTML接口时，才需要 <code>create</code> 和 <code>edit</code> 操作。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>例如，如果您有一个<a href="weblayer.html#restfulMappings">嵌套资源</a>，那么您通常希望同时查询父标识符和子标识符。例如，给定以下URL映射：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="string"><span class="delimiter">&quot;</span><span class="content">/authors</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">'</span><span class="content">author</span><span class="delimiter">'</span></span>) {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">/books</span><span class="delimiter">&quot;</span></span>(<span class="key">resources</span>:<span class="string"><span class="delimiter">'</span><span class="content">book</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>可以按如下方式实现嵌套控制器：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> <span class="directive">extends</span> RestfulController {
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>]
    BookController() {
        <span class="local-variable">super</span>(<span class="predefined-type">Book</span>)
    }

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">Book</span> queryForResource(<span class="predefined-type">Serializable</span> id) {
        <span class="predefined-type">Book</span>.where {
            id == id &amp;&amp; author.id == params.authorId
        }.find()
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>上面的示例将 <code>RestfulController</code> 子类化，并重写受保护的 <code>query for resource</code> 方法，以自定义资源的查询以将父资源考虑在内。</p>
</div>
<div class="sect3">
<h4 id="_在restfulcontroller子类中自定义数据绑定">在RestfulController子类中自定义数据绑定</h4>
<div class="paragraph">
<p>RestfulController类包含对 <code>save</code> 和 <code>update</code> 等操作进行数据绑定的代码。该类定义了一个 <code>getObjectToBind（）</code> 方法，该方法返回一个将用作数据绑定源的值。例如，update操作执行如下操作&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">RestfulController</span>&lt;T&gt; {

    <span class="keyword">def</span> <span class="function">update</span>() {
        T instance = <span class="comment">// retrieve instance from the database...</span>

        instance.properties = getObjectToBind()

        <span class="comment">// ...</span>
    }

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>默认情况下， <code>getObjectToBind（）</code> 方法返回<a href="../ref/Controllers/request.html">request</a>对象。当 <code>request</code> 对象用作绑定源时，如果请求有一个body，那么将解析body并使用其内容进行数据绑定，否则将使用请求参数进行数据绑定。RestfulController的子类可以重写 <code>getObjectToBind（）</code> 方法并返回任何有效的绑定源，包括 <a href="https://docs.oracle.com/javase/8/docs/api/java/util/Map.html">Map</a>或<a href="http://docs.grails.org/4.0.0/api/grails/databinding/databindingsource.html">DataBindingSource</a>。对于大多数绑定请求的用例来说是合适的，但是getObjectToBind（）方法允许在需要时更改该行为。</p>
</div>
</div>
<div class="sect3">
<h4 id="_在资源注释中使用restfulcontroller的自定义子类">在资源注释中使用RestfulController的自定义子类</h4>
<div class="paragraph">
<p>您还可以自定义支持资源注释的控制器的行为。</p>
</div>
<div class="paragraph">
<p>类必须提供以域类作为参数的构造函数。第二个构造函数用于支持readOnly=true的资源注释。</p>
</div>
<div class="paragraph">
<p>这是一个模板，可用于资源批注中使用的子类RestfulController类：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">SubclassRestfulController</span>&lt;T&gt; <span class="directive">extends</span> RestfulController&lt;T&gt; {
    SubclassRestfulController(<span class="predefined-type">Class</span>&lt;T&gt; domainClass) {
        <span class="local-variable">this</span>(domainClass, <span class="predefined-constant">false</span>)
    }

    SubclassRestfulController(<span class="predefined-type">Class</span>&lt;T&gt; domainClass, <span class="type">boolean</span> readOnly) {
        <span class="local-variable">super</span>(domainClass, readOnly)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>可以使用 <code>super class</code> 属性指定支持资源批注的控制器的超级类。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.*</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/books</span><span class="delimiter">'</span></span>, superClass=SubclassRestfulController)
<span class="type">class</span> <span class="class">Book</span> {

    <span class="predefined-type">String</span> title

    <span class="directive">static</span> constraints = {
        title <span class="key">blank</span>:<span class="predefined-constant">false</span>
    }
}</code></pre>
</div>
</div>
</div>


<h2 id="restControllersStepByStep">10.5.2 逐步实现 REST 控制器</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/restfulControllers/restControllersStepByStep.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如果您不想利用 <code>RestfulController</code> 超级类提供的功能，则可以自己手动实现每个HTTP动词。第一步是创建一个控制器：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> grails create-controller book</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后添加一些有用的导入，并默认启用readOnly：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.gorm.transactions.*</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.springframework.http.HttpStatus.*</span>
<span class="keyword">import</span> <span class="include">static</span> <span class="include">org.springframework.http.HttpMethod.*</span>

<span class="annotation">@Transactional</span>(readOnly = <span class="predefined-constant">true</span>)
<span class="type">class</span> <span class="class">BookController</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>回想一下，每个HTTP动词都根据以下约定与特定的Grails动作匹配：</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">HTTP Method</th>
<th class="tableblock halign-left valign-top">URI</th>
<th class="tableblock halign-left valign-top">Controller Action</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">index</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/create</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">create</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}/edit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">edit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">save</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PUT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELETE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/books/${id}</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">delete</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
如果您计划为REST资源实现HTML接口，则已经需要执行create和edit操作。它们在那里是为了呈现适当的HTML表单以创建和编辑资源。如果这不是必需的，则可以将其丢弃。
实施REST操作的关键是在Grails 2.3中引入的<a href="../ref/Controllers/respond.html">respond</a>方法。 <code>respond</code> 方法尝试为所请求的内容类型（JSON，XML，HTML等）产生最适当的响应。
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_实施_code_索引_code_行动">实施 <code>索引</code> 行动</h4>
<div class="paragraph">
<p>例如，要实现 <code>index</code> 动作，只需调用 <code>respond</code> 方法来传递对象列表以进行响应：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">index</span>(<span class="predefined-type">Integer</span> max) {
    params.max = <span class="predefined-type">Math</span>.min(max ?: <span class="integer">10</span>, <span class="integer">100</span>)
    respond <span class="predefined-type">Book</span>.list(params), <span class="key">model</span>:[<span class="key">bookCount</span>: <span class="predefined-type">Book</span>.count()]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意，在上面的示例中，我们还使用了 <code>respond</code> 方法的 <code>model</code> 参数来提供总数。仅当您计划通过某些用户界面支持分页时才需要。响应方法将使用<a href="theWebLayer.html＃contentNegotiation">Content Negotiation</a>，尝试根据客户端请求的内容类型（通过ACCEPT标头或文件扩展名）以最适当的响应进行回复。如果将内容类型确定为HTML，则将生成一个模型，使得上述操作等同于编写：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">index</span>(<span class="predefined-type">Integer</span> max) {
    params.max = <span class="predefined-type">Math</span>.min(max ?: <span class="integer">10</span>, <span class="integer">100</span>)
    [<span class="key">bookList</span>: <span class="predefined-type">Book</span>.list(params), <span class="key">bookCount</span>: <span class="predefined-type">Book</span>.count()]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>通过提供一个 <code>index.gsp</code> 文件，您可以为给定的模型渲染一个合适的视图。如果内容类型不是HTML，则 <code>respond</code> 方法将尝试查找适当的 <code>grails.rest.render.Renderer</code> 实例，该实例能够呈现传递的对象。这是通过检查 <code>grails.rest.render.RendererRegistry</code> 完成的。默认情况下，已经为JSON和XML配置了渲染器，要了解如何注册自定义渲染器，请参阅 <code>自定义响应渲染</code> 一节。</p>
</div>
</div>
<div class="sect3">
<h4 id="_实施_code_表演_code_行动">实施 <code>表演</code> 行动</h4>
<div class="paragraph">
<p>可以通过一行Groovy代码（不包括方法签名）来实现 <code>show</code> 操作，该操作用于按ID显示和单独显示资源：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">show</span>(<span class="predefined-type">Book</span> book) {
    respond book
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>通过将域实例指定为操作的参数，Grails将自动尝试使用请求的id参数查找域实例。如果域实例不存在，则将把 <code>null</code> 传递给操作。如果传递了null，则 <code>respond</code> 方法将返回404错误，否则它将再次尝试呈现适当的响应。如果格式为HTML，则将生成适当的模型。以下操作在功能上等同于上述操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">show</span>(<span class="predefined-type">Book</span> book) {
    <span class="keyword">if</span>(book == <span class="predefined-constant">null</span>) {
        render <span class="key">status</span>:<span class="integer">404</span>
    }
    <span class="keyword">else</span> {
        <span class="keyword">return</span> [<span class="key">book</span>: book]
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_实施_code_保存_code_动作">实施 <code>保存</code> 动作</h4>
<div class="paragraph">
<p>保存操作创建新的资源表示。首先，只需定义一个将资源作为第一个参数的动作，并使用 <code>grails.gorm.transactions.Transactional</code> 转换将其标记为 <code>Transactional</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Transactional</span>
<span class="keyword">def</span> <span class="function">save</span>(<span class="predefined-type">Book</span> book) {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后要做的第一件事是检查资源是否具有任何<a href="validation.html">validation errors</a>，如果有，则返回错误：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">if</span>(book.hasErrors()) {
    respond book.errors, <span class="key">view</span>:<span class="string"><span class="delimiter">'</span><span class="content">create</span><span class="delimiter">'</span></span>
}
<span class="keyword">else</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>对于HTML，将再次呈现 <code>创建</code> 视图，以便用户可以更正无效的输入。对于其他格式（JSON，XML等），错误对象本身将以适当的格式呈现，并返回状态码422（UNPROCESSABLE_ENTITY）。如果没有错误，则可以保存资源并发送适当的响应：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">book.save <span class="key">flush</span>:<span class="predefined-constant">true</span>
    withFormat {
        html {
            flash.message = message(<span class="key">code</span>: <span class="string"><span class="delimiter">'</span><span class="content">default.created.message</span><span class="delimiter">'</span></span>, <span class="key">args</span>: [message(<span class="key">code</span>: <span class="string"><span class="delimiter">'</span><span class="content">book.label</span><span class="delimiter">'</span></span>, <span class="keyword">default</span>: <span class="string"><span class="delimiter">'</span><span class="content">Book</span><span class="delimiter">'</span></span>), book.id])
            redirect book
        }
        <span class="string"><span class="delimiter">'</span><span class="content">*</span><span class="delimiter">'</span></span> { render <span class="key">status</span>: CREATED }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>在HTML的情况下，将重定向发送到原始资源，对于其他格式，将返回状态码201（已创建）。</p>
</div>
</div>
<div class="sect3">
<h4 id="_实施_code_更新_code_操作">实施 <code>更新</code> 操作</h4>
<div class="literalblock">
<div class="content">
<pre>`更新` 动作会更新现有的资源表示形式，并且与 `保存` 动作非常相似。首先定义方法签名：</pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Transactional</span>
<span class="keyword">def</span> <span class="function">update</span>(<span class="predefined-type">Book</span> book) {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果资源存在，则Grails将加载资源，否则将传递null。如果为null，则应返回404：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">if</span>(book == <span class="predefined-constant">null</span>) {
        render <span class="key">status</span>: NOT_FOUND
    }
    <span class="keyword">else</span> {
        ...
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后再次检查错误<a href="validation.html">validation errors</a>，如果是，请回答以下错误：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">if</span>(book.hasErrors()) {
    respond book.errors, <span class="key">view</span>:<span class="string"><span class="delimiter">'</span><span class="content">edit</span><span class="delimiter">'</span></span>
}
<span class="keyword">else</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>对于HTML，将再次呈现 <code>编辑</code> 视图，以便用户可以更正无效的输入。对于其他格式（JSON，XML等），错误对象本身将以适当的格式呈现，并返回状态码422（UNPROCESSABLE_ENTITY）。如果没有错误，则可以保存资源并发送适当的响应：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">book.save <span class="key">flush</span>:<span class="predefined-constant">true</span>
withFormat {
    html {
        flash.message = message(<span class="key">code</span>: <span class="string"><span class="delimiter">'</span><span class="content">default.updated.message</span><span class="delimiter">'</span></span>, <span class="key">args</span>: [message(<span class="key">code</span>: <span class="string"><span class="delimiter">'</span><span class="content">book.label</span><span class="delimiter">'</span></span>, <span class="keyword">default</span>: <span class="string"><span class="delimiter">'</span><span class="content">Book</span><span class="delimiter">'</span></span>), book.id])
        redirect book
    }
    <span class="string"><span class="delimiter">'</span><span class="content">*</span><span class="delimiter">'</span></span> { render <span class="key">status</span>: OK }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>在HTML的情况下，将重定向发送到原始资源，对于其他格式，将返回状态码200（OK）。</p>
</div>
</div>
<div class="sect3">
<h4 id="_实施_code_删除_code_操作">实施 <code>删除</code> 操作</h4>
<div class="paragraph">
<p><code>delete</code> 操作将删除现有资源。除了调用 <code>delete（）</code> 方法外，该实现与 <code>update</code> 操作非常相似：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">book.delete <span class="key">flush</span>:<span class="predefined-constant">true</span>
withFormat {
    html {
        flash.message = message(<span class="key">code</span>: <span class="string"><span class="delimiter">'</span><span class="content">default.deleted.message</span><span class="delimiter">'</span></span>, <span class="key">args</span>: [message(<span class="key">code</span>: <span class="string"><span class="delimiter">'</span><span class="content">Book.label</span><span class="delimiter">'</span></span>, <span class="keyword">default</span>: <span class="string"><span class="delimiter">'</span><span class="content">Book</span><span class="delimiter">'</span></span>), book.id])
        redirect <span class="key">action</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">index</span><span class="delimiter">&quot;</span></span>, <span class="key">method</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">GET</span><span class="delimiter">&quot;</span></span>
    }
    <span class="string"><span class="delimiter">'</span><span class="content">*</span><span class="delimiter">'</span></span>{ render <span class="key">status</span>: NO_CONTENT }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>请注意，对于HTML响应，将重定向发送回 <code>index</code> 操作，而对于其他内容类型，将返回响应代码204（NO_CONTENT）。</p>
</div>
</div>


<h2 id="generatingRestControllers">10.5.3 使用基架生成 REST 控制器</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/restfulControllers/generatingRestControllers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>要查看这些概念中的一些并帮助您继续使用， <a href="http://grails.org/plugins.html#plugin/scaffolding">scaffolding plugin</a>2.0版及更高版本可以为您生成一个REST-ready控制器，只需运行以下命令：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails generate-controller &lt;&lt;Domain Class Name&gt;&gt;</code></pre>
</div>
</div>


<h2 id="callingRestServices">10.6 使用 HttpClient 调用 REST 服务</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/callingRestServices.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>使用 <a href="https://docs.micronaut.io/latest/guide/index.html#httpClient">Micronaut HTTP客户端</a>，调用Grails REST服务以及第三方服务非常简单。该HTTP客户端同时具有低级API和高级AOP驱动的API，从而使其既可用于简单请求，也可用于构建声明性的类型安全的API层。</p>
</div>
<div class="paragraph">
<p>要使用Micronaut HTTP客户端，您必须在类路径上具有 <code>micronaut-http-client</code> 依赖项。将以下依赖项添加到您的build.gradle文件中。</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">'</span><span class="content">io.micronaut:micronaut-http-client</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_低级_api">低级 API</h4>
<div class="paragraph">
<p><a href="https://docs.micronaut.io/latest/api/io/micronaut/http/client/HttpClient.html">HttpClient</a>接口构成了低级API的基础。该接口声明了一些方法，以帮助简化执行HTTP请求和接收响应的过程。
HttpClient接口中的大多数方法都返回Reactive Streams Publisher实例，并且包含一个称为RxHttpClient的子接口，该子接口提供了HttpClient接口的变体，该接口返回RxJava Flowable类型。在阻塞流中使用HttpClient时，您可能希望调用toBlocking（）以返回 <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/client/BlockingHttpClient.html的实例">BlockingHttpClient</a>。</p>
</div>
<div class="paragraph">
<p>您可以通过几种方式获取对 <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/client/HttpClient.html">HttpClient</a>的引用。最简单的方法是使用 <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/client/HttpClient.html#create-java.net.URL-">create</a>方法</p>
</div>
<div class="listingblock">
<div class="title">创建一个HTTP客户端</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">    <span class="predefined-type">List</span>&lt;Album&gt; searchWithApi(<span class="predefined-type">String</span> searchTerm) {
        <span class="predefined-type">String</span> baseUrl = <span class="string"><span class="delimiter">&quot;</span><span class="content">https://itunes.apple.com/</span><span class="delimiter">&quot;</span></span>

        HttpClient client = HttpClient.create(baseUrl.toURL()).toBlocking() <i class="conum" data-value="1"></i><b>(1)</b>

        HttpRequest request = HttpRequest.GET(<span class="string"><span class="delimiter">&quot;</span><span class="content">/search?limit=25&amp;media=music&amp;entity=album&amp;term=</span><span class="inline"><span class="inline-delimiter">${</span>searchTerm<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>)
        HttpResponse&lt;<span class="predefined-type">String</span>&gt; resp = client.exchange(request, <span class="predefined-type">String</span>)
        client.close() <i class="conum" data-value="2"></i><b>(2)</b>

        <span class="predefined-type">String</span> json = resp.body()
        ObjectMapper objectMapper = <span class="keyword">new</span> ObjectMapper() <i class="conum" data-value="3"></i><b>(3)</b>
        objectMapper.configure(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES, <span class="predefined-constant">false</span>)
        <span class="predefined-type">SearchResult</span> searchResult = objectMapper.readValue(json, <span class="predefined-type">SearchResult</span>)
        searchResult.results
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>使用create方法创建一个新的HttpClient实例，并使用toBlocking（）将其转换为一个BlockingHttpClient实例</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>应该使用 <code>close</code> 方法关闭客户端，以防止线程泄漏。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>杰克逊的 <a href="https://fasterxml.github.io/jackson-databind/javadoc/2.9/com/fasterxml/jackson/databind/ObjectMapper.html">ObjectMapper</a> API可用于将原始JSON映射到POGO。案例 <code>SearchResult</code>。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>请参阅 <a href="https://docs.micronaut.io/latest/guide/index.html">Micronaut用户指南</a>的 <a href="https://docs.micronaut.io/latest/guide/index.html#lowLevelHttpClient">Http客户端部分</a>有关使用 <code>HttpClient</code> 低级API的更多信息。</p>
</div>
</div>
<div class="sect3">
<h4 id="_陈述式_api">陈述式 API</h4>
<div class="paragraph">
<p>可以通过将 <a href="https://docs.micronaut.io/latest/api/io/micronaut/http/client/annotation/Client.html"><code>@ Client</code></a>批注添加到任何接口或抽象类来编写声明性HTTP客户端。使用Micronaut的AOP支持（请参阅 <a href="https://docs.micronaut.io/latest/guide/index.html#introductionAdvice">Introduction Advice</a>上的Micronaut用户指南部分），抽象或接口方法将在编译时为您实现作为HTTP调用。声明性客户端可以返回数据绑定的POGO（或POJO），而无需调用代码进行特殊处理。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> example.grails

<span class="keyword">import</span> <span class="include">io.micronaut.http.annotation.Get</span>
<span class="keyword">import</span> <span class="include">io.micronaut.http.client.annotation.Client</span>

<span class="annotation">@Client</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">https://itunes.apple.com/</span><span class="delimiter">&quot;</span></span>)
<span class="type">interface</span> ItunesClient {

    <span class="annotation">@Get</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">/search?limit=25&amp;media=music&amp;entity=album&amp;term={term}</span><span class="delimiter">&quot;</span></span>)
    <span class="predefined-type">SearchResult</span> search(<span class="predefined-type">String</span> term)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>请注意，HTTP客户端方法使用适当的HTTP方法进行注释，例如 <code>@Get</code> 或 <code>@Post</code>。</p>
</div>
<div class="paragraph">
<p>要使用上面示例中的客户端，只需使用@Autowired批注将客户端的实例注入到任何bean中即可。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">  <span class="annotation">@Autowired</span>
    ItunesClient itunesClient

    <span class="predefined-type">List</span>&lt;Album&gt; searchAlbums(<span class="predefined-type">String</span> searchTerm) {
        <span class="predefined-type">SearchResult</span> searchResult = itunesClient.search(searchTerm)
        searchResult.results
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="/index.html">Micronaut用户指南</a>。 有关编写和使用声明性客户端的更多详细信息，请参阅https的 <a href="https://docs.micronaut.io/latest/guide/index.html#clientAnnotation">Http客户端部分</a>://docs.micronaut.io/latest/guide</p>
</div>
</div>


<h2 id="restProfile">10.7 REST 配置</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/restProfile.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>从Grails 3.1开始，Grails支持用于创建REST应用程序的量身定制的配置文件，该应用程序提供了更加集中的依赖性和命令集。</p>
</div>
<div class="paragraph">
<p>要开始使用REST概要文件，请创建一个应用程序，指定 <code>rest-api</code> 作为概要文件的名称：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-app my-api --profile rest-api</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将创建一个新的REST应用程序，该应用程序提供以下功能：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>用于创建和生成REST端点的默认命令集</p>
</li>
<li>
<p>默认为使用JSON视图来呈现响应（请参阅下一节）</p>
</li>
<li>
<p>少于默认Grails插件的插件（无GSP，无资产管道，无HTML相关）</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>例如，您会在grails-app / views目录中注意到有* .gson文件可用于呈现默认索引页以及任何404和500错误。</p>
</div>
<div class="paragraph">
<p>如果发出以下命令集：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-domain-class my.api.Book
$ grails generate-all my.api.Book</code></pre>
</div>
</div>
<div class="paragraph">
<p>代替CRUD HTML接口的是，生成了一个生成JSON响应的REST端点。另外，默认情况下，生成的功能和单元测试会测试REST端点。</p>
</div>


<h2 id="angularJsProfile">10.8 AngularJS 配置</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/angularJsProfile.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>从Grails 3.1开始，Grails支持使用AngularJS创建应用程序的配置文件，该配置文件提供了更加集中的依赖性和命令集。角度轮廓继承自REST轮廓，因此具有REST轮廓具有的所有命令和属性。
要开始使用AngularJS配置文件，请创建一个应用程序，将 <code>angularjs</code> 指定为配置文件的名称
**</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-app my-api --profile angularjs</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将创建一个新的Grails应用程序，该应用程序提供以下功能：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>用于创建AngularJS工件的默认命令集</p>
</li>
<li>
<p>Gradle插件来管理客户端依赖性</p>
</li>
<li>
<p>Gradle插件来执行客户端单元测试</p>
</li>
<li>
<p>Asset Pipeline插件可简化开发</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>默认情况下，AngularJS配置文件包含GSP支持以呈现索引页面。这是必需的，因为配置文件是围绕资产管道设计的。
新命令是：</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>create-ng-component</code></p>
</li>
<li>
<p><code>create-ng-controller</code></p>
</li>
<li>
<p><code>create-ng-directive</code></p>
</li>
<li>
<p><code>create-ng-domain</code></p>
</li>
<li>
<p><code>create-ng-module</code></p>
</li>
<li>
<p><code>create-ng-service</code></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_项目结构">项目结构</h4>
<div class="paragraph">
<p>AngularJS配置文件是围绕特定项目结构设计的。 <code>create-ng</code> 命令将自动创建不存在的模块。
例:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-ng-controller foo</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将在grails-app/assets/javascripts/${默认包名称} / controllers中生成一个fooController.js文件。
注意：默认情况下，angularjs配置文件将在 <code>javascripts</code> 目录中创建文件。您可以在配置中使用 <code>grails.codegen.angular.assettir</code> 键更改该行为。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-ng-domain foo.bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将在 <code>grails app/assets/javascripts/foo/domains</code> 中生成一个 <code>Bar.js</code> 文件。它还将创建 <code>FoO</code> 模块，如果它不存在的话。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-ng-module foo.bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将在 <code>grails app/assets/javascripts/foo/bar</code> 中生成一个 <code>foo.bar.js</code> 文件。注意模块的命名约定与其他人工制品不同。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-ng-service foo.bar --type constant</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将在 <code>grails app/assets/javascripts/foo/services</code> 中生成一个 <code>bar.js</code> 文件。它还将创建 <code>FoO</code> 模块，如果它不存在的话。 <code>create ng service</code> 命令接受标志 <code>type</code>。可使用的类型有：</p>
</div>
<div class="ulist">
<ul>
<li>
<p>服务</p>
</li>
<li>
<p>工厂_默认值_</p>
</li>
<li>
<p>价值</p>
</li>
<li>
<p>提供者</p>
</li>
<li>
<p>常数</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>除了artefacts本身，概要文件还将为每个create命令在 <code>src/test/javascripts</code> 下生成一个框架单元测试文件。</p>
</div>
</div>
<div class="sect3">
<h4 id="_客户端依赖性">客户端依赖性</h4>
<div class="paragraph">
<p><a href="https://github.com/craigburke/bowerinstallergradle">gradle bower Plugin</a> 用于管理与bower的依赖关系。访问插件文档了解如何使用插件。</p>
</div>
</div>
<div class="sect3">
<h4 id="_单元测试">单元测试</h4>
<div class="paragraph">
<p><a href="https://github.com/craigburke/karmagradle">gradle karma Plugin</a>用于执行客户端单元测试。所有生成的测试都是用Jasmine编写的。访问插件文档了解如何使用插件。</p>
</div>
</div>
<div class="sect3">
<h4 id="_资产管道">资产管道</h4>
<div class="paragraph">
<p>AngularJS概要文件包括几个资产管道插件，使开发更容易。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/craigburke/js-closure-wrap-asset-pipeline">js closure wrap asset pipeline</a>将在立即调用的函数表达式中包装角度代码。</p>
</li>
<li>
<p><a href="https://github.com/craigburke/angular-annotate-asset-pipeline">annotate-asset-pipeline</a>将对依赖项进行注释，以便安全地进行缩小。</p>
</li>
<li>
<p><a href="https://github.com/craigburke/angular-template-asset-pipeline">template-asset-pipeline</a>会将模板放入 <code>$templateCache</code> 中，以防止http请求检索模板。</p>
</li>
</ul>
</div>
</div>


<h2 id="angularProfile">10.9 Angular 配置</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/angularProfile.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>从Grails 3.2.1开始，Grails支持使用Angular创建应用程序的配置文件，该配置文件提供了面向未来的设置。此配置文件的最大变化是，该配置文件创建了一个多项目gradle构建。这是第一个这样做的配置文件。 Angular配置文件依赖于 <a href="https://github.com/angular/angular-cli">Angular CLI</a>来管理客户端应用程序。服务器端应用程序与使用 <code>rest-api</code> 配置文件创建的应用程序相同。要开始使用Angular概要文件，请创建一个应用程序，将 <code>angular</code> 指定为概要文件的名称：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ grails create-app my-app --profile angular</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将创建一个包含以下内容的 <code>my-app</code> 目录：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>client/
gradle/
gradlew
gradlew.bat
server/
settings.gradle</code></pre>
</div>
</div>
<div class="paragraph">
<p>整个客户端应用程序位于 <code>client</code> 文件夹中，而整个服务器应用程序位于 <code>server</code> 文件夹中。</p>
</div>
<div class="sect3">
<h4 id="_先决条件">先决条件</h4>
<div class="paragraph">
<p>要使用此配置文件，您应该安装了Node，NPM和Angular CLI。节点至少应为版本5​​，NPM应至少为版本3。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.npmjs.com/getting-started/installing-node">Node &amp;&amp; NPM</a></p>
</li>
<li>
<p><a href="https://github.com/angular/angular-cli#installation">Angular CLI</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_项目结构">项目结构</h4>
<div class="paragraph">
<p>Angular配置文件旨在与 <a href="https://github.com/angular/angular-cli">Angular CLI</a>一起使用。 CLI用于创建概要文件的客户端应用程序端。 CLI提供了用于执行客户端应用程序要执行的大多数操作的命令，包括创建组件或服务。因此，概要文件本身不提供执行相同操作的命令。</p>
</div>
</div>
<div class="sect3">
<h4 id="_运行应用">运行应用</h4>
<div class="paragraph">
<p>仅执行服务器端应用程序，您可以在 <code>server</code> 项目中执行 <code>bootRun</code> 任务：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew server:bootRun</code></pre>
</div>
</div>
<div class="paragraph">
<p>可以对客户端应用程序执行相同的操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew client:bootRun</code></pre>
</div>
</div>
<div class="paragraph">
<p>要同时执行这两项，您必须并行执行：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew bootRun --parallel</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
必须并行执行此操作，因为默认情况下，Gradle会同步执行任务，并且两个bootRun任务都不会 <code>完成</code>。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_测试">测试</h4>
<div class="paragraph">
<p>配置文件随附的默认客户端应用程序提供了一些可以执行的测试。要在应用程序中执行测试：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew test</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>test</code> 任务将与Karma和Jasmine一起执行单元测试。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">./gradlew integrationTest</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>integrationTest</code> 任务将使用量角器执行e2e测试。
TIP: 您可以在每个子项目上执行 <code>test</code> 和 <code>integrationTest</code> 任务，就像执行 <code>bootRun</code> 一样。</p>
</div>
</div>
<div class="sect3">
<h4 id="_cors">CORS</h4>
<div class="paragraph">
<p>由于客户端和服务器端将在单独的端口上运行，因此需要进行CORS配置。默认情况下，配置文件将配置服务器端以允许通过以下配置来自所有主机的CORS：</p>
</div>
<div class="listingblock">
<div class="title">server/grails-app/conf/application.yml</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span class="key">grails</span>:
    <span class="key">cors</span>:
        <span class="key">enabled</span>: <span class="string"><span class="content">true</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>请参阅以下部分 <a href="theWebLayer.html#cors">CORS</a> 在用户指南中获取有关根据需要配置此功能的信息。</p>
</div>
</div>


<h2 id="jsonViews">10.10 JSON 视图</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/jsonViews.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如上一节所述，REST概要文件默认情况下使用JSON视图来呈现JSON响应。它们起着与GSP类似的作用，但是经过优化，可用于输出JSON响应而不是HTML。</p>
</div>
<div class="paragraph">
<p>您可以根据MVC继续分离应用程序，而应用程序的逻辑位于控制器和服务中，而视图相关事务则由JSON视图处理。</p>
</div>
<div class="paragraph">
<p>JSON视图还提供了灵活性，可以轻松地自定义呈现给客户端的JSON，而不必诉诸相对复杂的编组库，例如Jackson或Grails的marshaller API。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
自从 Grails 3.1, JSON Grails团队认为，视图是向客户端显示JSON输出的最佳方法，有关编写自定义编组器的部分已从用户指南中删除。如果您正在寻找有关该主题的信息，请参阅 <a href="http://grails.github.io/grails-doc/3.0.x/guide/webServices.html#objectMarshallers">the Grails 3.0.x guide</a>.
</td>
</tr>
</table>
</div>


<h2 id="jsonViewsSetup">10.10.1 入门</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/jsonViews/jsonViewsSetup.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如果您使用的是REST或AngularJS配置文件，那么JSON视图插件将已经包括在内，您可以跳过本节的其余部分。否则，您需要修改 <code>build.gradle</code> 以包含激活JSON视图所需的插件：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">compile <span class="string"><span class="delimiter">'</span><span class="content">org.grails.plugins:views-json:1.0.0</span><span class="delimiter">'</span></span> <span class="comment">// or whatever is the latest version</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>提示：如果您需要更多的文档和贡献，可以在github上找到 <a href="https://github.com/grails/grails视图">JSON视图的源代码存储库</a></p>
</div>
<div class="paragraph">
<p>为了编译用于生产部署的JSON视图，还应该首先修改 <code>buildscript</code> 块来激活Gradle插件：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
    ...
    dependencies {
        ...
        classpath <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails.plugins:views-gradle:1.0.0</span><span class="delimiter">&quot;</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后在任何grails核心Gradle插件之后应用 <code>org.grails.plugins.views json</code> Gradle插件：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">...
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails.grails-web</span><span class="delimiter">&quot;</span></span>
apply <span class="key">plugin</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">org.grails.plugins.views-json</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>这将向Gradle添加一个 <code>compileGsonViews</code> 任务，该任务在创建生产JAR或WAR文件之前被调用。</p>
</div>


<h2 id="jsonViewsCreating">10.10.2 创建 JSON 视图</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/jsonViews/jsonViewsCreating.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>JSON视图进入 <code>grails-app / views</code> 目录，并以 <code>.gson</code> 后缀结尾。它们是常规的Groovy脚本，可以在任何Groovy编辑器中打开</p>
</div>
<div class="paragraph">
<p>JSON视图示例:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">json.person {
    name <span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
要在Intellij IDEA的Groovy编辑器中打开它们，请双击该文件，然后在询问与之关联的文件时，选择 <code>Groovy</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>上面的JSON视图产生:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="json">{<span class="key"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>:{<span class="key"><span class="delimiter">&quot;</span><span class="content">name</span><span class="delimiter">&quot;</span></span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">bob</span><span class="delimiter">&quot;</span></span>}}</code></pre>
</div>
</div>
<div class="paragraph">
<p>有一个隐式的 <code>json</code> 变量，它是 <a href="http://docs.groovy-lang.org/latest/html/api/groovy/json/StreamingJsonBuilder.html">StreamingJsonBuilder</a>的实例。</p>
</div>
<div class="paragraph">
<p>用法示例:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">json(<span class="integer">1</span>,<span class="integer">2</span>,<span class="integer">3</span>) == <span class="string"><span class="delimiter">&quot;</span><span class="content">[1,2,3]</span><span class="delimiter">&quot;</span></span>
json { name <span class="string"><span class="delimiter">&quot;</span><span class="content">Bob</span><span class="delimiter">&quot;</span></span> } == <span class="string"><span class="delimiter">'</span><span class="content">{&quot;name&quot;:&quot;Bob&quot;}</span><span class="delimiter">'</span></span>
json([<span class="integer">1</span>,<span class="integer">2</span>,<span class="integer">3</span>]) { n <span class="local-variable">it</span> } == <span class="string"><span class="delimiter">'</span><span class="content">[{&quot;n&quot;:1},{&quot;n&quot;:2},{&quot;n&quot;:3}]</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>有关可能的更多信息，请参阅 <a href="http://docs.groovy-lang.org/latest/html/api/groovy/json/StreamingJsonBuilder.html">StreamingJsonBuilder</a>上的API文档。</p>
</div>


<h2 id="jsonViewsAndTemplates">10.10.3 JSON 视图模板</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/jsonViews/jsonViewsAndTemplates.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>您可以定义下划线 <code>_</code> 开头的模板。例如，给定以下名为 <code>_person.gson</code> 的模板：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    Person person
}
json {
    name person.name
    age person.age
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以使用如下视图进行渲染：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    Family family
}
json {
    name family.father.name
    age family.father.age
    oldestChild g.render(<span class="key">template</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>, <span class="key">model</span>:[<span class="key">person</span>: family.children.max { Person p -&gt; p.age } ])
    children g.render(<span class="key">template</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">person</span><span class="delimiter">&quot;</span></span>, <span class="key">collection</span>: family.children, <span class="key">var</span>:<span class="string"><span class="delimiter">'</span><span class="content">person</span><span class="delimiter">'</span></span>)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>或者，使用tmpl变量以更简洁的方式调用模板：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    Family family
}
json {
    name family.father.name
    age family.father.age
    oldestChild tmpl.person( family.children.max { Person p -&gt; p.age } ] )
    children tmpl.person( family.children )
}</code></pre>
</div>
</div>


<h2 id="jsonViewsAndDomainClasses">10.10.4 使用 JSON 视图呈现域类</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/jsonViews/jsonViewsAndDomainClasses.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>通常，您的模型可能涉及一个或多个域实例。 JSON视图提供了一种渲染方法。</p>
</div>
<div class="paragraph">
<p>例如，给定以下域类：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">Book</span> {
    <span class="predefined-type">String</span> title
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>和以下模板：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">model {
    <span class="predefined-type">Book</span> book
}

json g.render(book)</code></pre>
</div>
</div>
<div class="paragraph">
<p>结果输出为：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">{<span class="key">id</span>:<span class="integer">1</span>, <span class="key">title</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>}</code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以通过包含或排除属性来自定义渲染：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">json g.render(book, [<span class="key">includes</span>:[<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>]])</code></pre>
</div>
</div>
<div class="paragraph">
<p>或通过提供一个闭包来添加其他JSON输出：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">json g.render(book) {
    pages <span class="integer">1000</span>
}</code></pre>
</div>
</div>


<h2 id="jsonViewsTemplatesAndConventions">10.10.5 按约定进行的 JSON 视图</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/jsonViews/jsonViewsTemplatesAndConventions.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>创建JSON视图时，可以遵循一些有用的约定。例如，如果您有一个名为 <code>Book</code> 的域类，然后在 <code>grails-app/views/book/_book.gson</code> 处创建一个模板，并使用<a href="../ref/Controllers/respond.html">respond</a>方法将导致呈现模板：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">show</span>(<span class="predefined-type">Long</span> id) {
    respond <span class="predefined-type">Book</span>.get(id)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>另外，如果默认情况下在验证过程中发生错误，Grails将尝试渲染一个名为 <code>grails-app/views/book/_errors.gson</code> 的模板，否则它将尝试渲染 <code>grails-app/views/errors/_errors.gson</code>  如果前者不存在。这很有用，因为当持久化对象时，您可以 <code>响应</code> 验证错误以呈现上述模板：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="annotation">@Transactional</span>
<span class="keyword">def</span> <span class="function">save</span>(<span class="predefined-type">Book</span> book) {
    <span class="keyword">if</span> (book.hasErrors()) {
        transactionStatus.setRollbackOnly()
        respond book.errors
    }
    <span class="keyword">else</span> {
        <span class="comment">// valid object</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果在上面的示例中发生验证错误，则会显示 <code>grails-app/views/book/_errors.gson</code> 模板。有关JSON视图（和标记视图）的更多信息，请参见 <a href="http://views.grails.org/latest/">JSON Views user guide</a>.</p>
</div>


<h2 id="renderers">10.11 自定义响应呈现</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/renderers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如果您正在寻找更底层的API，而JSON或Markup视图不适合您的需求，那么您可能要考虑实现自定义渲染器。</p>
</div>


<h2 id="defaultRenderers">10.11.1 自定义默认渲染器</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/renderers/defaultRenderers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>XML和JSON的默认呈现器分别位于 <code>grails.rest.render.XML</code> 和 <code>grails.rest.render.JSON</code> 包中。默认情况下，它们使用Grails转换器（ <code>Grails.converters.XML</code> 和 <code>Grails.converters.JSON</code> ）进行响应呈现。</p>
</div>
<div class="paragraph">
<p>可以使用这些默认呈现器轻松自定义响应呈现。您可能要进行的一个常见更改是在渲染中包含或排除某些属性。</p>
</div>
<div class="sect3">
<h4 id="_包括或排除渲染中的属性">包括或排除渲染中的属性</h4>
<div class="paragraph">
<p>如前所述，Grails维护 <code>Grails.rest.render.Renderer</code> 实例的注册表。有一些默认配置的呈现器以及为给定域类甚至为域类集合注册或重写呈现器的能力。要包含来自呈现的特定属性，您需要通过在 <code>grails app/conf/spring/resources.groovy</code> 中定义bean来注册自定义呈现器：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.xml.*</span>

beans = {
    bookRenderer(XmlRenderer, <span class="predefined-type">Book</span>) {
        includes = [<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意：bean名称并不重要（Grails将扫描所有注册的呈现器bean的应用程序上下文），但出于组织和可读性的目的，建议您将其命名为有意义的名称。</p>
</div>
<div class="paragraph">
<p>要排除属性，可以使用 <code>XmlRenderer</code> 类的 <code>excludes</code> 属性：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.xml.*</span>

beans = {
    bookRenderer(XmlRenderer, <span class="predefined-type">Book</span>) {
        excludes = [<span class="string"><span class="delimiter">'</span><span class="content">isbn</span><span class="delimiter">'</span></span>]
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_自定义转换器">自定义转换器</h3>
<div class="paragraph">
<p>如前所述，默认呈现使用封面下的 <code>grails.converters</code> 包。换言之，在封面下，他们基本上做了以下工作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.converters.*</span>

...
render book <span class="keyword">as</span> XML

<span class="comment">// or render book as JSON</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>为什么转换器和渲染器之间要分离？渲染器有更大的灵活性来使用你所选择的渲染技术。在实现自定义渲染器时，可以使用 <a href="http://wiki.fasterxml.com/JacksonHome">Jackson</a>、 <a href="http://code.google.com/p/googlegson/">gson</a>或任何Java库来实现渲染器。另一方面，转换器与Grails自己的封送处理实现紧密相连。</p>
</div>
</div>


<h2 id="customRenderers">10.11.2 实现自定义渲染器</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/renderers/customRenderers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>如果您想要对呈现进行更多的控制，或者更喜欢使用自己的封送处理技术，那么可以实现自己的 <code>Renderer</code> 实例。例如，下面是一个自定义 <code>Book</code> 类呈现的简单实现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> myapp
<span class="keyword">import</span> <span class="include">grails.rest.render.*</span>
<span class="keyword">import</span> <span class="include">grails.web.mime.MimeType</span>

<span class="type">class</span> <span class="class">BookXmlRenderer</span> <span class="directive">extends</span> AbstractRenderer&lt;<span class="predefined-type">Book</span>&gt; {
    BookXmlRenderer() {
        <span class="local-variable">super</span>(<span class="predefined-type">Book</span>, [MimeType.XML,MimeType.TEXT_XML] <span class="keyword">as</span> MimeType<span class="type">[]</span>)
    }

    <span class="type">void</span> render(<span class="predefined-type">Book</span> object, <span class="predefined-type">RenderContext</span> context) {
        context.contentType = MimeType.XML.name

        <span class="keyword">def</span> xml = <span class="keyword">new</span> groovy.xml.MarkupBuilder(context.writer)
        xml.book(<span class="key">id</span>: object.id, <span class="key">title</span>:object.title)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>AbstractRenderer</code> 超级类有一个构造函数，该构造函数接受它所呈现的类和（通过ACCEPT头或文件扩展名）为呈现器接受的 <code>MimeType</code> 。
要配置这个渲染器，只需将它作为一个bean添加到 <code>grails app/conf/spring/resources.groovy</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">beans = {
    bookRenderer(myapp.BookXmlRenderer)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>结果将是所有 <code>Book</code> 实例将以以下格式呈现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">&lt;book id=<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span> title=<span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>/&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意：如果您将呈现更改为与上述完全不同的格式，那么如果您计划支持POST和PUT请求，还需要更改绑定。否则Grails将不会自动知道如何将数据从自定义XML格式绑定到域类。有关详细信息，请参阅 <code>自定义资源绑定</code> 一节。</p>
</div>
<div class="sect3">
<h4 id="_容器渲染器">容器渲染器</h4>
<div class="paragraph">
<p><code>grails.rest.render.ContainerRenderer</code> 是为对象容器（列表、映射、集合等）呈现响应的呈现程序。该接口与 <code>Renderer</code> 接口基本相同，只是添加了 <code>getComponentType（）</code> 方法，该方法应返回 <code>contained</code> 类型。例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookListRenderer</span> <span class="directive">implements</span> ContainerRenderer&lt;<span class="predefined-type">List</span>, <span class="predefined-type">Book</span>&gt; {
    <span class="predefined-type">Class</span>&lt;<span class="predefined-type">List</span>&gt; getTargetType() { <span class="predefined-type">List</span> }
    <span class="predefined-type">Class</span>&lt;<span class="predefined-type">Book</span>&gt; getComponentType() { <span class="predefined-type">Book</span> }
    MimeType<span class="type">[]</span> getMimeTypes() { [ MimeType.XML] <span class="keyword">as</span> MimeType<span class="type">[]</span> }
    <span class="type">void</span> render(<span class="predefined-type">List</span> object, <span class="predefined-type">RenderContext</span> context) {
        ....
    }
}</code></pre>
</div>
</div>
</div>


<h2 id="gspRenderers">10.11.3 使用 GSP 自定义渲染</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/renderers/gspRenderers.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>您还可以使用Groovy服务器页面（GSP）根据每个操作自定义呈现。例如，考虑到前面提到的 <code>show</code> 操作：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">show</span>(<span class="predefined-type">Book</span> book) {
    respond book
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>您可以提供一个 <code>show.xml.gsp</code> 文件来自定义xml的呈现：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">&lt;%<span class="annotation">@page</span> contentType=<span class="string"><span class="delimiter">&quot;</span><span class="content">application/xml</span><span class="delimiter">&quot;</span></span>%&gt;
&lt;book id=<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>book.id<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span> title=<span class="string"><span class="delimiter">&quot;</span><span class="inline"><span class="inline-delimiter">${</span>book.title<span class="inline-delimiter">}</span></span><span class="delimiter">&quot;</span></span>/&gt;</code></pre>
</div>
</div>


<h2 id="hypermedia">10.12 超媒体作为应用程序状态的引擎</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/hypermedia.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://en.wikipedia.org/wiki/HATEOAS">HATEOAS</a>是Hypermedia作为应用程序状态引擎的缩写，是一种应用到REST体系结构的通用模式，该模式使用超媒体并通过链接来定义REST API。</p>
</div>
<div class="paragraph">
<p>超媒体（也称为Mime或媒体类型）用于描述REST资源的状态，链接告诉客户端如何过渡到下一个状态。响应的格式通常为JSON或XML，尽管标准格式如 <a href="http://tools.ietf.org/html/rfc4287">Atom</a>和/或 <a href="http://stateless.co/hal_specification.html">HAL</a>是经常使用。</p>
</div>


<h2 id="hal">10.12.1 HAL 支持</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/hypermedia/hal.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://stateless.co/hal_specification.html">HAL</a>是开发遵循HATEOAS原理的REST API时常用的标准交换格式。代表订单列表的示例HAL文档如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
    <span class="key"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/orders</span><span class="delimiter">&quot;</span></span> },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">next</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/orders?page=2</span><span class="delimiter">&quot;</span></span> },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">find</span><span class="delimiter">&quot;</span></span>: {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/orders{?id}</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">templated</span><span class="delimiter">&quot;</span></span>: <span class="predefined-constant">true</span>
        },
        <span class="key"><span class="delimiter">&quot;</span><span class="content">admin</span><span class="delimiter">&quot;</span></span>: [{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/admins/2</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Fred</span><span class="delimiter">&quot;</span></span>
        }, {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/admins/5</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Kate</span><span class="delimiter">&quot;</span></span>
        }]
    },
    <span class="key"><span class="delimiter">&quot;</span><span class="content">currentlyProcessing</span><span class="delimiter">&quot;</span></span>: <span class="integer">14</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">shippedToday</span><span class="delimiter">&quot;</span></span>: <span class="integer">20</span>,
    <span class="key"><span class="delimiter">&quot;</span><span class="content">_embedded</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">order</span><span class="delimiter">&quot;</span></span>: [{
            <span class="key"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/orders/123</span><span class="delimiter">&quot;</span></span> },
                <span class="key"><span class="delimiter">&quot;</span><span class="content">basket</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/baskets/98712</span><span class="delimiter">&quot;</span></span> },
                <span class="key"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/customers/7809</span><span class="delimiter">&quot;</span></span> }
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">total</span><span class="delimiter">&quot;</span></span>: <span class="float">30.00</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">currency</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">USD</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">shipped</span><span class="delimiter">&quot;</span></span>
        }, {
            <span class="key"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
                <span class="key"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/orders/124</span><span class="delimiter">&quot;</span></span> },
                <span class="key"><span class="delimiter">&quot;</span><span class="content">basket</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/baskets/97213</span><span class="delimiter">&quot;</span></span> },
                <span class="key"><span class="delimiter">&quot;</span><span class="content">customer</span><span class="delimiter">&quot;</span></span>: { <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">/customers/12369</span><span class="delimiter">&quot;</span></span> }
            },
            <span class="key"><span class="delimiter">&quot;</span><span class="content">total</span><span class="delimiter">&quot;</span></span>: <span class="float">20.00</span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">currency</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">USD</span><span class="delimiter">&quot;</span></span>,
            <span class="key"><span class="delimiter">&quot;</span><span class="content">status</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">processing</span><span class="delimiter">&quot;</span></span>
        }]
    }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_使用hal公开资源">使用HAL公开资源</h4>
<div class="paragraph">
<p>要为资源返回HAL而不是常规JSON，您可以简单地在 <code>grails-app/conf/spring/resources.groovy</code> 中使用 <code>grails.rest.render.hal.HalJsonRenderer</code> （或 <code>HalXmlRenderer</code> ）实例覆盖渲染器对于XML版本）：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.hal.*</span>
beans = {
    halBookRenderer(HalJsonRenderer, rest.test.Book)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>您还需要更新资源的可接受响应格式，以便包含HAL格式。不这样做将导致服务器返回406-Not Acceptable响应。</p>
</div>
<div class="paragraph">
<p>这可以通过设置 <code>资源</code> 转换的 <code>格式</code> 属性来完成：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.*</span>

<span class="annotation">@Resource</span>(uri=<span class="string"><span class="delimiter">'</span><span class="content">/books</span><span class="delimiter">'</span></span>, formats=[<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">hal</span><span class="delimiter">'</span></span>])
<span class="type">class</span> <span class="class">Book</span> {
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>或通过更新控制器中的 <code>responseFormats</code> ：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> <span class="directive">extends</span> RestfulController {
    <span class="directive">static</span> responseFormats = [<span class="string"><span class="delimiter">'</span><span class="content">json</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">xml</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">hal</span><span class="delimiter">'</span></span>]

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>放置适当的bean并请求HAL内容类型时，将返回HAL：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> curl -i -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Accept: application/hal+json</span><span class="delimiter">&quot;</span></span> <span class="key">http</span>:<span class="comment">//localhost:8080/books/1</span>

HTTP/<span class="float">1.1</span> <span class="integer">200</span> OK
<span class="key">Server</span>: Apache-Coyote/<span class="float">1.1</span>
Content-<span class="predefined-type">Type</span>: application/hal+json;charset=ISO-<span class="integer">8859</span>-<span class="integer">1</span>

{
  <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
      <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/1</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
    }
  },
  <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="content">The Stand</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>要使用HAL XML格式，只需更改渲染器即可：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.hal.*</span>
beans = {
    halBookRenderer(HalXmlRenderer, rest.test.Book)
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_使用hal渲染集合">使用HAL渲染集合</h4>
<div class="paragraph">
<p>要返回HAL而不是常规JSON作为资源列表，您可以简单地在 <code>grails-app / conf / spring / resources.groovy</code> 中使用 <code>grails.rest.render.hal.HalJsonCollectionRenderer</code> 实例覆盖渲染器：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.hal.*</span>
beans = {
    halBookCollectionRenderer(HalJsonCollectionRenderer, rest.test.Book)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>放置适当的bean并请求HAL内容类型时，将返回HAL：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> curl -i -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Accept: application/hal+json</span><span class="delimiter">&quot;</span></span> <span class="key">http</span>:<span class="comment">//localhost:8080/books</span>
HTTP/<span class="float">1.1</span> <span class="integer">200</span> OK
<span class="key">Server</span>: Apache-Coyote/<span class="float">1.1</span>
Content-<span class="predefined-type">Type</span>: application/hal+json;charset=UTF-<span class="integer">8</span>
Transfer-<span class="key">Encoding</span>: chunked
<span class="predefined-type">Date</span>: Thu, <span class="integer">17</span> Oct <span class="integer">2013</span> <span class="octal">02</span>:<span class="integer">34</span>:<span class="integer">14</span> GMT

{
  <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
      <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
    }
  },
  <span class="string"><span class="delimiter">&quot;</span><span class="content">_embedded</span><span class="delimiter">&quot;</span></span>: {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">book</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
          <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/1</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>
      },
      {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
          <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/2</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Infinite Jest</span><span class="delimiter">&quot;</span></span>
      },
      {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
          <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/3</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Walden</span><span class="delimiter">&quot;</span></span>
      }
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>注意，与呈现的JSON中的Book对象列表相关的键是book，它是从集合中的对象类型Book派生的。为了自定义此键的值，将一个值分配给 <code>HalJsonCollectionRenderer</code>  bean上的 <code>collectionName</code> 属性，如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.hal.*</span>
beans = {
    halBookCollectionRenderer(HalCollectionJsonRenderer, rest.test.Book) {
        collectionName = <span class="string"><span class="delimiter">'</span><span class="content">publications</span><span class="delimiter">'</span></span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>设置好之后，渲染的HAL将如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> curl -i -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Accept: application/hal+json</span><span class="delimiter">&quot;</span></span> <span class="key">http</span>:<span class="comment">//localhost:8080/books</span>
HTTP/<span class="float">1.1</span> <span class="integer">200</span> OK
<span class="key">Server</span>: Apache-Coyote/<span class="float">1.1</span>
Content-<span class="predefined-type">Type</span>: application/hal+json;charset=UTF-<span class="integer">8</span>
Transfer-<span class="key">Encoding</span>: chunked
<span class="predefined-type">Date</span>: Thu, <span class="integer">17</span> Oct <span class="integer">2013</span> <span class="octal">02</span>:<span class="integer">34</span>:<span class="integer">14</span> GMT

{
  <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
      <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
    }
  },
  <span class="string"><span class="delimiter">&quot;</span><span class="content">_embedded</span><span class="delimiter">&quot;</span></span>: {
    <span class="string"><span class="delimiter">&quot;</span><span class="content">publications</span><span class="delimiter">&quot;</span></span>: [
      {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
          <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/1</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">The Stand</span><span class="delimiter">&quot;</span></span>
      },
      {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
          <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/2</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Infinite Jest</span><span class="delimiter">&quot;</span></span>
      },
      {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
          <span class="string"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/3</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
            <span class="string"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/hal+json</span><span class="delimiter">&quot;</span></span>
          }
        },
        <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Walden</span><span class="delimiter">&quot;</span></span>
      }
    ]
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_使用自定义媒体_mime类型">使用自定义媒体/ MIME类型</h4>
<div class="paragraph">
<p>如果您想使用自定义的Mime类型，则首先需要在grails-app/conf/application.groovy中声明Mime类型：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.mime.types = [
    <span class="key">all</span>:      <span class="string"><span class="delimiter">&quot;</span><span class="content">*/*</span><span class="delimiter">&quot;</span></span>,
    <span class="key">book</span>:     <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json</span><span class="delimiter">&quot;</span></span>,
    <span class="key">bookList</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.booklist+json</span><span class="delimiter">&quot;</span></span>,
    ...
]</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
将新的MIME类型放在 <code>所有</code>  MIME类型之后非常重要，因为如果无法建立请求的内容类型，则映射中的第一个条目将用作响应。如果您的新Mime类型位于顶部，那么在无法建立请求的Mime类型时，Grails将始终尝试发送新的Mime类型。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>然后覆盖渲染器以使用自定义Mime类型返回HAL：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.hal.*</span>
<span class="keyword">import</span> <span class="include">grails.web.mime.*</span>

beans = {
    halBookRenderer(HalJsonRenderer, rest.test.Book, <span class="keyword">new</span> MimeType(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json</span><span class="delimiter">&quot;</span></span>, [<span class="key">v</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>]))
    halBookListRenderer(HalJsonCollectionRenderer, rest.test.Book, <span class="keyword">new</span> MimeType(<span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.booklist+json</span><span class="delimiter">&quot;</span></span>, [<span class="key">v</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>]))
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>在上面的示例中，第一个bean为单个图书实例定义了一个HAL渲染器，该实例返回Mime类型为application/vnd.books.org.book + json的Hime渲染器。第二个bean定义了用于呈现书籍集合的Mime Type（在本例中为application/vnd.books.org.booklist + json）。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>application/vnd.books.org.booklist+json</code> 是媒体范围的一个例子 (<a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html" class="bare">http://www.w3.org/Protocols/rfc2616/rfc2616.html</a> - 标头字段定义).  本示例使用实体（书）和操作（列表）形成媒体​​范围值，但实际上，可能没有必要为每个操作创建单独的Mime类型。此外，可能没有必要在实体级别创建Mime类型。有关如何定义自己的Mime类型的更多信息，请参见 <code>版本化REST资源</code> 部分。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>通过此操作发出对新Mime类型的请求，将返回必要的HAL：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="bash">$ curl -i -H &quot;Accept: application/vnd.books.org.book+json&quot; http://localhost:8080/books/1

HTTP/1.1 200 OK
Server: Apache-Coyote/1.1
Content-Type: application/vnd.books.org.book+json;charset=ISO-8859-1

{
  &quot;_links&quot;: {
    &quot;self&quot;: {
      &quot;href&quot;: &quot;http://localhost:8080/books/1&quot;,
      &quot;hreflang&quot;: &quot;en&quot;,
      &quot;type&quot;: &quot;application/vnd.books.org.book+json&quot;
    }
  },
  &quot;title&quot;: &quot;\&quot;The Stand\&quot;&quot;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_自定义链接渲染">自定义链接渲染</h4>
<div class="paragraph">
<p>HATEOAS的一个重要方面是链接的使用，这些链接描述了客户端可以用来与REST API交互的过渡。默认情况下， <code>HalJsonRenderer</code> 将自动为您创建关联以链接到资源本身（使用 <code>自我</code> 关系）。</p>
</div>
<div class="paragraph">
<p>但是，您可以使用 <code>链接</code> 方法来自定义链接渲染，该方法添加到所有以 <code>grails.rest.Resource</code> 注释的域类或任何以 <code>grails.rest.Linkable</code> 注释的类中。例如，可以对show动作进行如下修改，以在结果输出中提供新的链接：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">def</span> <span class="function">show</span>(<span class="predefined-type">Book</span> book) {
    book.link <span class="key">rel</span>:<span class="string"><span class="delimiter">'</span><span class="content">publisher</span><span class="delimiter">'</span></span>, <span class="key">href</span>: g.createLink(<span class="key">absolute</span>: <span class="predefined-constant">true</span>, <span class="key">resource</span>:<span class="string"><span class="delimiter">&quot;</span><span class="content">publisher</span><span class="delimiter">&quot;</span></span>, <span class="key">params</span>:[<span class="key">bookId</span>: book.id])
    respond book
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>这将导致输出，例如：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">self</span><span class="delimiter">&quot;</span></span>: {
      <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/1</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>,
      <span class="key"><span class="delimiter">&quot;</span><span class="content">type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">application/vnd.books.org.book+json</span><span class="delimiter">&quot;</span></span>
    }
    <span class="string"><span class="delimiter">&quot;</span><span class="content">publisher</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/books/1/publisher</span><span class="delimiter">&quot;</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">hreflang</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">en</span><span class="delimiter">&quot;</span></span>
    }
  },
  <span class="key"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="char">\&quot;</span><span class="content">The Stand</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>可以传递 <code>link</code> 方法的命名参数来匹配 <code>grails.rest.Link</code> 类的属性。</p>
</div>
</div>


<h2 id="atom">10.12.2 Atom 支持</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/hypermedia/atom.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="http://tools.ietf.org/html/rfc4287">Atom</a> 是用于实现REST API的另一种标准交换格式。 Atom输出的示例如下所示：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="tag">&lt;feed</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2005/Atom</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

 <span class="tag">&lt;title&gt;</span>Example Feed<span class="tag">&lt;/title&gt;</span>
 <span class="tag">&lt;link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://example.org/</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
 <span class="tag">&lt;updated&gt;</span>2003-12-13T18:30:02Z<span class="tag">&lt;/updated&gt;</span>
 <span class="tag">&lt;author&gt;</span>
   <span class="tag">&lt;name&gt;</span>John Doe<span class="tag">&lt;/name&gt;</span>
 <span class="tag">&lt;/author&gt;</span>
 <span class="tag">&lt;id&gt;</span>urn:uuid:60a76c80-d399-11d9-b93C-0003939e0af6<span class="tag">&lt;/id&gt;</span>

 <span class="tag">&lt;entry&gt;</span>
   <span class="tag">&lt;title&gt;</span>Atom-Powered Robots Run Amok<span class="tag">&lt;/title&gt;</span>
   <span class="tag">&lt;link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://example.org/2003/12/13/atom03</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
   <span class="tag">&lt;id&gt;</span>urn:uuid:1225c695-cfb8-4ebb-aaaa-80da344efa6a<span class="tag">&lt;/id&gt;</span>
   <span class="tag">&lt;updated&gt;</span>2003-12-13T18:30:02Z<span class="tag">&lt;/updated&gt;</span>
   <span class="tag">&lt;summary&gt;</span>Some text.<span class="tag">&lt;/summary&gt;</span>
 <span class="tag">&lt;/entry&gt;</span>

<span class="tag">&lt;/feed&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>要再次使用Atom渲染，只需定义一个自定义渲染器即可：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">grails.rest.render.atom.*</span>
beans = {
    halBookRenderer(AtomRenderer, rest.test.Book)
    halBookListRenderer(AtomCollectionRenderer, rest.test.Book)
}</code></pre>
</div>
</div>


<h2 id="vndError">10.12.3 Vnd.错误支持</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/hypermedia/vndError.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p><a href="https://github.com/blongden/vnd.error">Vnd.Error</a> 是表达错误响应的标准化方法。</p>
</div>
<div class="paragraph">
<p>默认情况下，当尝试发布新资源时发生验证错误时，错误对象将以422响应代码发送回allow：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> curl -i -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Accept: application/json</span><span class="delimiter">&quot;</span></span>  -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type: application/json</span><span class="delimiter">&quot;</span></span> -X POST -d <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span> <span class="key">http</span>:<span class="comment">//localhost:8080/books</span>

HTTP/<span class="float">1.1</span> <span class="integer">422</span> Unprocessable <span class="predefined-type">Entity</span>
<span class="key">Server</span>: Apache-Coyote/<span class="float">1.1</span>
Content-<span class="predefined-type">Type</span>: application/json;charset=ISO-<span class="integer">8859</span>-<span class="integer">1</span>

{
  <span class="string"><span class="delimiter">&quot;</span><span class="content">errors</span><span class="delimiter">&quot;</span></span>: [
    {
      <span class="string"><span class="delimiter">&quot;</span><span class="content">object</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">rest.test.Book</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">field</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">title</span><span class="delimiter">&quot;</span></span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">rejected-value</span><span class="delimiter">&quot;</span></span>: <span class="predefined-constant">null</span>,
      <span class="string"><span class="delimiter">&quot;</span><span class="content">message</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Property [title] of class [class rest.test.Book] cannot be null</span><span class="delimiter">&quot;</span></span>
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果您想将格式更改为Vnd.Error，则只需在grails-app/conf/spring/resources.groovy中注册 <code>grails.rest.render.errors.VndErrorJsonRenderer</code>  bean：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">beans = {
    vndJsonErrorRenderer(grails.rest.render.errors.VndErrorJsonRenderer)
    <span class="comment">// for Vnd.Error XML format</span>
    vndXmlErrorRenderer(grails.rest.render.errors.VndErrorXmlRenderer)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>然后，如果您更改客户端请求以接受Vnd.Error，则会得到适当的响应：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="error">$</span> curl -i -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Accept: application/vnd.error+json,application/json</span><span class="delimiter">&quot;</span></span> -H <span class="string"><span class="delimiter">&quot;</span><span class="content">Content-Type: application/json</span><span class="delimiter">&quot;</span></span> -X POST -d <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span> <span class="key">http</span>:<span class="comment">//localhost:8080/books</span>
HTTP/<span class="float">1.1</span> <span class="integer">200</span> OK
<span class="key">Server</span>: Apache-Coyote/<span class="float">1.1</span>
Content-<span class="predefined-type">Type</span>: application/vnd.error+json;charset=ISO-<span class="integer">8859</span>-<span class="integer">1</span>

[
    {
        <span class="string"><span class="delimiter">&quot;</span><span class="content">logref</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">book.nullable,</span></span><span class="error">
</span>        <span class="string"><span class="delimiter">&quot;</span><span class="content">message</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Property [title] of class [class rest.test.Book] cannot be null</span><span class="delimiter">&quot;</span></span>,
        <span class="string"><span class="delimiter">&quot;</span><span class="content">_links</span><span class="delimiter">&quot;</span></span>: {
            <span class="string"><span class="delimiter">&quot;</span><span class="content">resource</span><span class="delimiter">&quot;</span></span>: {
                <span class="string"><span class="delimiter">&quot;</span><span class="content">href</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">http://localhost:8080/rest-test/books</span><span class="delimiter">&quot;</span></span>
            }
        }
    }
]</code></pre>
</div>
</div>


<h2 id="binding">10.13 自定义资源绑定</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/binding.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>该框架提供了一种复杂而简单的机制，用于将REST请求绑定到域对象和命令对象。利用这种方法的一种方法是在控制器中将 <code>request</code> 属性绑定到域类的 <code>properties</code>。给定以下XML作为请求的主体，<code>createBook</code> 操作将创建一个新的 <code>Book</code>，并将 <code>The Stand</code> 分配给 <code>title</code> 属性，并将 <code>Stephen King</code> 分配给 <code>authorName</code> 属性。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">&lt;?xml version=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span> encoding=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>?&gt;
&lt;book&gt;
    &lt;title&gt;The Stand&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">title&gt;</span></span><span class="error">
</span>    &lt;authorName&gt;Stephen King&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">authorName&gt;</span></span><span class="error">
</span>&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">book&gt;</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> {

    <span class="keyword">def</span> <span class="function">createBook</span>() {
        <span class="keyword">def</span> book = <span class="keyword">new</span> <span class="predefined-type">Book</span>()
        book.properties = request

        <span class="comment">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>命令对象将自动与请求主体绑定：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> {
    <span class="keyword">def</span> <span class="function">createBook</span>(BookCommand book) {

        <span class="comment">// ...</span>
    }
}

<span class="type">class</span> <span class="class">BookCommand</span> {
    <span class="predefined-type">String</span> title
    <span class="predefined-type">String</span> authorName
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>如果命令对象类型是域类，并且XML文档的根元素包含id属性，则id值将用于从数据库中检索相应的持久化实例，然后其余文档将被保存。绑定到实例。如果在数据库中找不到相应的记录，则命令对象引用将为null。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">&lt;?xml version=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span> encoding=<span class="string"><span class="delimiter">&quot;</span><span class="content">UTF-8</span><span class="delimiter">&quot;</span></span>?&gt;
&lt;book id=<span class="string"><span class="delimiter">&quot;</span><span class="content">42</span><span class="delimiter">&quot;</span></span>&gt;
    &lt;title&gt;Walden&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">title&gt;</span></span><span class="error">
</span>    &lt;authorName&gt;Henry David Thoreau&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">authorName&gt;</span></span><span class="error">
</span>&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">book&gt;</span></span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">BookController</span> {
    <span class="keyword">def</span> <span class="function">updateBook</span>(<span class="predefined-type">Book</span> book) {
        <span class="comment">// The book will have been retrieved from the database and updated</span>
        <span class="comment">// by doing something like this:</span>
        <span class="comment">//</span>
        <span class="comment">// book == Book.get('42')</span>
        <span class="comment">// if(book != null) {</span>
        <span class="comment">//    book.properties = request</span>
        <span class="comment">// }</span>
        <span class="comment">//</span>
        <span class="comment">// the code above represents what the framework will</span>
        <span class="comment">// have done. There is no need to write that code.</span>

        <span class="comment">// ...</span>

    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>数据绑定取决于<a href="http://docs.grails.org/4.0.0/api/org/grails/databinding/bindingsource/DataBindingSourceCreator.html">DataBindingSourceCreator</a>接口的实例创建的<a href="http://docs.grails.org/4.0.0/api/grails/databinding/DataBindingSource.html">DataBindingSource</a>接口的实例。将根据请求的 <code>contentType</code> 选择 <code>DataBindingSourceCreator</code> 的特定实现。提供了几种实现来处理常见的内容类型。对于大多数用例，默认实现都可以。下表列出了核心框架支持的内容类型以及每种类型使用的 <code>DataBindingSourceCreator</code> 实现。所有的实现类都在org.grails.databinding.bindingsource包中。</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">内容类型，Bean名称，DataBindingSourceCreator Impl。</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application / xml，text / xml</code>，xmlDataBindingSourceCreator，XmlDataBindingSourceCreator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>application / json，text / json</code>，jsonDataBindingSourceCreator，JsonDataBindingSourceCreator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">应用程序/ hal + json，halJsonDataBindingSourceCreator，HalJsonDataBindingSourceCreator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">应用程序/ hal + xml，halXmlDataBindingSourceCreator，HalXmlDataBindingSourceCreator</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>为了为任何这些内容类型提供自己的 <code>DataBindingSourceCreator</code>，请编写一个实现
使用DataBindingSourceCreator并在Spring应用程序上下文中注册该类的实例。如果你
要替换现有的帮助程序之一，请使用上面的相应Bean名称。如果您要提供
内容类型的助手，而不是核心框架所考虑的内容，bean名称可以是
您喜欢，但应注意不要与上述bean名称之一冲突。</p>
</div>
<div class="paragraph">
<p>DataBindingSourceCreator接口仅定义了两种方法：</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> org.grails.databinding.bindingsource

<span class="keyword">import</span> <span class="include">grails.web.mime.MimeType</span>
<span class="keyword">import</span> <span class="include">grails.databinding.DataBindingSource</span>

<span class="comment">/**
 * A factory for DataBindingSource instances
 *
 * @since 2.3
 * @see DataBindingSourceRegistry
 * @see DataBindingSource
 *
 */</span>
<span class="type">interface</span> DataBindingSourceCreator {

    <span class="comment">/**
     * `return All of the {`link MimeType} supported by this helper
     */</span>
    MimeType<span class="type">[]</span> getMimeTypes()

    <span class="comment">/**
     * Creates a DataBindingSource suitable for binding bindingSource to bindingTarget
     *
     * @param mimeType a mime type
     * @param bindingTarget the target of the data binding
     * @param bindingSource the value being bound
     * @return a DataBindingSource
     */</span>
    DataBindingSource createDataBindingSource(MimeType mimeType, <span class="predefined-type">Object</span> bindingTarget, <span class="predefined-type">Object</span> bindingSource)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="http://docs.grails.org/4.0.0/api/org/grails/web/databinding/bindingsource/AbstractRequestBodyDataBindingSourceCreator.html">AbstractRequestBodyDataBindingSourceCreator</a>
是一个抽象类，旨在扩展以简化编写自定义 <code>DataBindingSourceCreator</code> 类的过程。哪个班
扩展 <code>AbstractRequestbodyDatabindingSourceCreator</code> 需要实现一个名为 <code>createBindingSource</code> 的方法
它接受InputStream作为参数并返回DataBindingSource以及实现getMimeTypes
上面的 <code>DataBindingSourceCreator</code> 接口中描述的方法。 createBindingSource的InputStream参数
提供对请求正文的访问。</p>
</div>
<div class="paragraph">
<p>下面的代码展示了一个简单的实现。</p>
</div>
<div class="listingblock">
<div class="title">src/main/groovy/com/demo/myapp/databinding/MyCustomDataBindingSourceCreator.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> com.demo.myapp.databinding

<span class="keyword">import</span> <span class="include">grails.web.mime.MimeType</span>
<span class="keyword">import</span> <span class="include">grails.databinding.DataBindingSource</span>
<span class="keyword">import</span> <span class="include">org</span>...<span class="include">databinding.SimpleMapDataBindingSource</span>
<span class="keyword">import</span> <span class="include">org</span>...<span class="include">databinding.bindingsource.AbstractRequestBodyDataBindingSourceCreator</span>

<span class="comment">/**
 * A custom DataBindingSourceCreator capable of parsing key value pairs out of
 * a request body containing a comma separated list of key:value pairs like:
 *
 * name:Herman,age:99,town:STL
 *
 */</span>
<span class="type">class</span> <span class="class">MyCustomDataBindingSourceCreator</span> <span class="directive">extends</span> AbstractRequestBodyDataBindingSourceCreator {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> MimeType<span class="type">[]</span> getMimeTypes() {
        [<span class="keyword">new</span> MimeType(<span class="string"><span class="delimiter">'</span><span class="content">text/custom+demo+csv</span><span class="delimiter">'</span></span>)] <span class="keyword">as</span> MimeType<span class="type">[]</span>
    }

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> DataBindingSource createBindingSource(<span class="predefined-type">InputStream</span> inputStream) {
        <span class="keyword">def</span> map = [:]

        <span class="keyword">def</span> reader = <span class="keyword">new</span> <span class="predefined-type">InputStreamReader</span>(inputStream)

        <span class="comment">// this is an obviously naive parser and is intended</span>
        <span class="comment">// for demonstration purposes only.</span>

        reader.eachLine { line -&gt;
            <span class="keyword">def</span> keyValuePairs = line.split(<span class="string"><span class="delimiter">'</span><span class="content">,</span><span class="delimiter">'</span></span>)
            keyValuePairs.each { keyValuePair -&gt;
                <span class="keyword">if</span>(keyValuePair?.trim()) {
                    <span class="keyword">def</span> keyValuePieces = keyValuePair.split(<span class="string"><span class="delimiter">'</span><span class="content">:</span><span class="delimiter">'</span></span>)
                    <span class="keyword">def</span> key = keyValuePieces[<span class="integer">0</span>].trim()
                    <span class="keyword">def</span> value = keyValuePieces[<span class="integer">1</span>].trim()
                    map&lt;&lt;key&gt;&gt; = value
                }
            }
        }

        <span class="comment">// create and return a DataBindingSource which contains the parsed data</span>
        <span class="keyword">new</span> SimpleMapDataBindingSource(map)
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>需要在spring应用程序上下文中注册 <code>MyCustomDataSourceCreator</code> 的实例。</p>
</div>
<div class="listingblock">
<div class="title">grails-app/conf/spring/resources.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">beans = {

    myCustomCreator com.demo.myapp.databinding.MyCustomDataBindingSourceCreator

    <span class="comment">// ...</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>有了它，框架将在任何需要 <code>DataBindingSourceCreator</code> 的时候使用 <code>myCustomCreator</code> bean
处理 <code>contentType</code> 为 <code>text/custom+demo+csv</code> 的请求。</p>
</div>

<a name="8.3 RSS &#21644; Atom"><!-- Legacy link --></a>
<h2 id="RSSAndAtom">10.14 RSS 和 Atom</h2>

<div class='contribute-btn'>
    <button type='button' class='btn btn-default' onclick='window.location.href="https://github.com/grails/grails-doc/edit/master/src/en/guide/REST/RSSAndAtom.adoc"'>
        <i class='fa fa-pencil-square-o'></i> Improve this doc
    </button>
</div>


<div class="paragraph">
<p>Grails中没有为RSS或Atom提供直接支持。您可以使用<a href="../ref/Controllers/render.html">render</a>方法的XML功能来构造RSS或ATOM提要。</p>
</div>


                <div style="clear:both;margin-top:15px;"></div>
                
                    <div class="toc-item prev-left"><a href="../guide/traits.html">&lt;&lt; <strong>9</strong><span>&#29305;&#24449;&#65288;Trait&#65289;</span></a></div>
                
                    <div class="toc-item next-right"><a href="../guide/async.html"><strong>11</strong><span>&#24322;&#27493;&#32534;&#31243;</span> >></a></div>
                
                <div style="clear:both"></div>
            </div>
        </td>
        <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Command%20Line/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/bug-report.html">bug-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/clean.html">clean</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/compile.html">compile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/console.html">console</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-app.html">create-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-command.html">create-command</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-controller.html">create-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-domain-class.html">create-domain-class</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-functional-test.html">create-functional-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-hibernate-cfg-xml.html">create-hibernate-cfg-xml</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-integration-test.html">create-integration-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-interceptor.html">create-interceptor</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-plugin.html">create-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-profile.html">create-profile</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-script.html">create-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-service.html">create-service</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-taglib.html">create-taglib</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/create-unit-test.html">create-unit-test</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/dependency-report.html">dependency-report</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/docs.html">docs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-all.html">generate-all</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-controller.html">generate-controller</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/generate-views.html">generate-views</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/help.html">help</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/install-templates.html">install-templates</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/list-plugins.html">list-plugins</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/list-profiles.html">list-profiles</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/package-plugin.html">package-plugin</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/package.html">package</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/plugin-info.html">plugin-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/profile-info.html">profile-info</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-app.html">run-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-command.html">run-command</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/run-script.html">run-script</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/schema-export.html">schema-export</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/shell.html">shell</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/stats.html">stats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/stop-app.html">stop-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/test-app.html">test-app</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Command%20Line/war.html">war</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Constraints</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Constraints/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Constraints/attributes.html">attributes</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/bindable.html">bindable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/blank.html">blank</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/creditCard.html">creditCard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/email.html">email</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/inList.html">inList</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/matches.html">matches</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/max.html">max</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/maxSize.html">maxSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/min.html">min</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/minSize.html">minSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/notEqual.html">notEqual</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/nullable.html">nullable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/range.html">range</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/scale.html">scale</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/size.html">size</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/unique.html">unique</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/url.html">url</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/validator.html">validator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Constraints/widget.html">widget</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Controllers</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Controllers/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Controllers/actionName.html">actionName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/allowedMethods.html">allowedMethods</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/bindData.html">bindData</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/chain.html">chain</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/controllerName.html">controllerName</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/defaultAction.html">defaultAction</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/flash.html">flash</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/forward.html">forward</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/grailsApplication.html">grailsApplication</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/namespace.html">namespace</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/params.html">params</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/redirect.html">redirect</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/render.html">render</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/respond.html">respond</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/responseFormats.html">responseFormats</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/session.html">session</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/withForm.html">withForm</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Controllers/withFormat.html">withFormat</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Database Mapping</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Database%20Mapping/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/autoImport.html">autoImport</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/autoTimestamp.html">autoTimestamp</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/batchSize.html">batchSize</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/cache.html">cache</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/cascade.html">cascade</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/column.html">column</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/comment.html">comment</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/discriminator.html">discriminator</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/dynamicInsert.html">dynamicInsert</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/dynamicUpdate.html">dynamicUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/fetch.html">fetch</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/id.html">id</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/ignoreNotFound.html">ignoreNotFound</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/indexColumn.html">indexColumn</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/insertable.html">insertable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/joinTable.html">joinTable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/lazy.html">lazy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/order.html">order</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/sort.html">sort</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/table.html">table</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/type.html">type</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/updateable.html">updateable</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Database%20Mapping/version.html">version</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Domain Classes</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Domain%20Classes/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/addTo.html">addTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/attach.html">attach</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/belongsTo.html">belongsTo</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/clearErrors.html">clearErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/constraints.html">constraints</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/count.html">count</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/countBy.html">countBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/createCriteria.html">createCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/delete.html">delete</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/discard.html">discard</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/embedded.html">embedded</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/errors.html">errors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/executeQuery.html">executeQuery</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/executeUpdate.html">executeUpdate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/exists.html">exists</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/fetchMode.html">fetchMode</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/find.html">find</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAll.html">findAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAllBy.html">findAllBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findAllWhere.html">findAllWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findBy.html">findBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrCreateBy.html">findOrCreateBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrCreateWhere.html">findOrCreateWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrSaveBy.html">findOrSaveBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findOrSaveWhere.html">findOrSaveWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/findWhere.html">findWhere</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/first.html">first</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/get.html">get</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getAll.html">getAll</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getDirtyPropertyNames.html">getDirtyPropertyNames</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/getPersistentValue.html">getPersistentValue</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasErrors.html">hasErrors</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasMany.html">hasMany</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/hasOne.html">hasOne</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/ident.html">ident</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/instanceOf.html">instanceOf</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/isAttached.html">isAttached</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/isDirty.html">isDirty</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/last.html">last</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/list.html">list</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/listOrderBy.html">listOrderBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/load.html">load</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/lock.html">lock</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mapWith.html">mapWith</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mappedBy.html">mappedBy</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/mapping.html">mapping</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/merge.html">merge</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/namedQueries.html">namedQueries</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/properties.html">properties</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/read.html">read</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/refresh.html">refresh</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/removeFrom.html">removeFrom</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/save.html">save</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/transients.html">transients</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/validate.html">validate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/where.html">where</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/whereAny.html">whereAny</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withCriteria.html">withCriteria</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withNewSession.html">withNewSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withSession.html">withSession</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Domain%20Classes/withTransaction.html">withTransaction</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Plug-ins</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Plug-ins/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/URL%20mappings.html">URL mappings</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/codecs.html">codecs</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/controllers.html">controllers</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/core.html">core</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/dataSource.html">dataSource</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/domainClasses.html">domainClasses</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/hibernate.html">hibernate</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/i18n.html">i18n</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/logging.html">logging</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/scaffolding.html">scaffolding</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/services.html">services</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Plug-ins/servlets.html">servlets</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Services</h1><div class="menu-sub">
                        
                            <div class="menu-item"><a href="../ref/Services/Usage.html">Usage</a></div>
                            
                            
                            <div class="menu-item"><a href="../ref/Services/scope.html">scope</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Services/transactional.html">transactional</a>
                            </div>
                            
                            </div>
                    </div>
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Servlet API</h1><div class="menu-sub">
                        
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/request.html">request</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/response.html">response</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/servletContext.html">servletContext</a>
                            </div>
                            
                            <div class="menu-item"><a href="../ref/Servlet%20API/session.html">session</a>
                            </div>
                            
                            </div>
                    </div>
                    
                </div>
            </div>
        </td>
    </tr>
</table>

<div id="footer">
    Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.
    
</div>

<script type="text/javascript" src="../js/docs.js"></script>

</body>
</html>
